<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>My Website</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700;900&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
:root{--g1:#1a4a2e;--g2:#2d7a4f;--g3:#3da66a;--g4:#6ecf96;--g5:#b8eece;--g6:#e8f8ef;--white:#fff;--text:#1a2e22;--muted:#5a7a65;--border:#c8e8d4;}
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0;}
body{font-family:'DM Sans',sans-serif;background:var(--white);color:var(--text);overflow-x:hidden;}

/* NAV */
.pub-nav{position:sticky;top:0;z-index:50;background:rgba(255,255,255,0.95);backdrop-filter:blur(12px);border-bottom:1.5px solid var(--border);padding:0 48px;height:66px;display:flex;align-items:center;justify-content:space-between;}
.pub-nav .logo{font-family:'Playfair Display',serif;font-size:1.45rem;font-weight:700;color:var(--g1);letter-spacing:-.02em;cursor:pointer;text-decoration:none;}
.pub-nav .logo span{color:var(--g3);}
.pub-nav-right{display:flex;align-items:center;gap:8px;}
.pub-nav-links{display:flex;align-items:center;gap:4px;}
.pub-nav-links a{padding:7px 16px;border-radius:10px;font-size:.88rem;color:var(--muted);cursor:pointer;text-decoration:none;transition:all .15s;font-weight:500;}
.pub-nav-links a:hover{background:var(--g6);color:var(--g1);}
.pub-nav-links a.active{background:var(--g5);color:var(--g1);font-weight:600;}
#admin-mode-btn{display:none;padding:7px 16px;border-radius:10px;font-size:.85rem;font-weight:600;cursor:pointer;font-family:inherit;background:var(--g1);color:white;border:none;transition:all .2s;align-items:center;gap:6px;}
#admin-mode-btn:hover{background:var(--g2);}

/* HERO */
.pub-hero{background:linear-gradient(135deg,var(--g1) 0%,var(--g2) 55%,#2a8a55 100%);padding:110px 48px 105px;position:relative;overflow:hidden;}
.pub-hero::after{content:'';position:absolute;bottom:-1px;left:0;right:0;height:80px;background:var(--white);clip-path:polygon(0 100%,100% 100%,100% 30%,0 100%);}
.pub-hero.compact{padding:65px 48px 75px;}
.hero-inner{position:relative;max-width:780px;}
#pub-title{font-family:'Playfair Display',serif;font-size:clamp(2.4rem,5.5vw,4rem);font-weight:900;color:var(--white);line-height:1.1;margin-bottom:18px;}
#pub-subtitle{font-size:1.12rem;color:rgba(255,255,255,.82);line-height:1.7;max-width:560px;font-weight:300;}

/* GENERIC PAGE CONTENT */
.pub-content{max-width:860px;margin:0 auto;padding:60px 48px 80px;}
.page-content-area{line-height:1.8;font-size:1.02rem;}
.page-content-area h1,.page-content-area h2,.page-content-area h3{font-family:'Playfair Display',serif;color:var(--g1);margin:1.3em 0 .5em;}
.page-content-area h1{font-size:2rem;}.page-content-area h2{font-size:1.5rem;}.page-content-area h3{font-size:1.2rem;}
.page-content-area p{margin-bottom:1em;}
.page-content-area a{color:var(--g2);}
.page-content-area img{max-width:100%;border-radius:14px;margin:16px 0;display:block;box-shadow:0 4px 20px rgba(0,0,0,.1);}
.page-content-area ul,.page-content-area ol{padding-left:1.6em;margin-bottom:1em;}
.page-content-area blockquote{border-left:4px solid var(--g3);padding:10px 20px;background:var(--g6);border-radius:0 10px 10px 0;color:var(--muted);font-style:italic;margin:1em 0;}
.page-content-area hr{border:none;border-top:2px solid var(--border);margin:2em 0;}

/* FOOTER */
.pub-footer{background:var(--g1);color:rgba(255,255,255,.5);text-align:center;padding:32px 24px;font-size:.85rem;}

/* SECRET ADMIN LINK */
#admin-link{position:fixed;bottom:14px;right:18px;font-size:.68rem;color:var(--muted);cursor:pointer;opacity:.35;transition:opacity .2s;text-decoration:none;z-index:10;background:none;border:none;font-family:inherit;}
#admin-link:hover{opacity:1;}

/* â•â• HOME PAGE â•â• */
.home-features-section{background:var(--g6);padding:64px 0 72px;border-bottom:2px solid var(--border);}
.home-section-wrap{max-width:1100px;margin:0 auto;padding:0 48px;}
.home-section-label{font-size:.72rem;font-weight:700;text-transform:uppercase;letter-spacing:.14em;color:var(--g3);margin-bottom:8px;}
.home-section-heading{font-family:'Playfair Display',serif;font-size:1.85rem;font-weight:900;color:var(--g1);margin-bottom:36px;line-height:1.2;}

/* CAROUSEL */
.feat-carousel-outer{position:relative;padding:0 44px;}
.feat-carousel-clip{overflow:hidden;border-radius:4px;padding:16px 0;margin:-16px 0;}
.feat-carousel-track{display:flex;gap:16px;transition:transform .5s cubic-bezier(.4,0,.2,1);will-change:transform;align-items:center;}
.feat-carousel-track.no-transition{transition:none!important;}
/* When <=4 cards: centered flex, no scroll */
.feat-centered{display:flex;flex-wrap:wrap;gap:20px;justify-content:center;}
/* Carousel: side cards are smaller/dimmer, center card pops */
.home-feature-card{background:white;border:1.5px solid var(--border);border-radius:18px;padding:28px 24px 24px;display:flex;flex-direction:column;gap:12px;transition:transform .4s cubic-bezier(.4,0,.2,1),box-shadow .4s,scale .4s cubic-bezier(.4,0,.2,1),opacity .4s;text-decoration:none;color:inherit;position:relative;overflow:hidden;flex-shrink:0;scale:0.86;opacity:0.55;}
.home-feature-card.carousel-center{scale:1.0;opacity:1;box-shadow:0 14px 44px rgba(0,0,0,.14);border-color:var(--g3);}
.home-feature-card:hover{box-shadow:0 8px 28px rgba(0,0,0,.1);}
.home-feature-card:hover{transform:translateY(-4px);box-shadow:0 10px 32px rgba(0,0,0,.1);border-color:var(--g4);}
/* Carousel dots */
.feat-dots{display:flex;justify-content:center;gap:7px;margin-top:22px;}
.feat-dot{width:8px;height:8px;border-radius:50%;background:var(--border);border:none;cursor:pointer;padding:0;transition:all .2s;}
.feat-dot.active{background:var(--g3);transform:scale(1.3);}
/* Carousel nav arrows â€” sit in the 48px padding on each side */
.feat-arrow{position:absolute;top:50%;transform:translateY(-50%);z-index:5;background:var(--g1);border:none;border-radius:50%;width:38px;height:38px;display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:1rem;color:white;box-shadow:0 3px 14px rgba(0,0,0,.22);transition:all .2s;}
.feat-arrow:hover{background:var(--g2);transform:translateY(-50%) scale(1.1);}
.feat-arrow-left{left:4px;}.feat-arrow-right{right:4px;}

/* FEATURE CARDS â€” consistent rounded rectangle */
.home-feature-card{background:white;border:1.5px solid var(--border);border-radius:18px;padding:28px 24px 24px;display:flex;flex-direction:column;gap:12px;transition:transform .2s,box-shadow .2s;text-decoration:none;color:inherit;position:relative;overflow:hidden;}
.home-feature-card:hover{transform:translateY(-4px);box-shadow:0 10px 32px rgba(0,0,0,.1);border-color:var(--g4);}
.hfc-img{width:100%;height:160px;border-radius:10px;background-size:cover;background-position:center;background-color:var(--g5);margin-bottom:4px;display:flex;align-items:center;justify-content:center;font-size:2rem;color:var(--muted);overflow:hidden;flex-shrink:0;}
.hfc-img img{width:100%;height:100%;object-fit:cover;}
.hfc-icon-wrap{font-size:2.2rem;line-height:1;}
.hfc-title{font-family:'Playfair Display',serif;font-size:1.05rem;font-weight:700;color:var(--g1);line-height:1.3;}
.hfc-desc{font-size:.88rem;color:var(--muted);line-height:1.65;flex:1;}

/* GALLERY */
.home-gallery-section{padding:68px 0;background:var(--white);}
.home-gallery-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(250px,1fr));gap:16px;}
.home-gallery-item{border-radius:16px;overflow:hidden;background:var(--g5);aspect-ratio:4/3;position:relative;cursor:pointer;transition:transform .2s,box-shadow .2s;}
.home-gallery-item:hover{transform:translateY(-3px);box-shadow:0 8px 24px rgba(0,0,0,.12);}
.home-gallery-img{width:100%;height:100%;background-size:cover;background-position:center;}
.home-gallery-caption{position:absolute;bottom:0;left:0;right:0;background:linear-gradient(transparent,rgba(0,0,0,.6));padding:24px 14px 12px;color:white;font-size:.82rem;opacity:0;transition:opacity .2s;}
.home-gallery-item:hover .home-gallery-caption{opacity:1;}

/* POSTS */
.home-posts-section{background:var(--g6);border-top:2px solid var(--border);padding:68px 0;}
.home-video-section{background:var(--g1);padding:68px 0;}
.home-video-section .home-section-label{color:var(--g4);}
.home-video-section .home-section-heading{color:white;}
.home-video-container{position:relative;width:100%;max-width:800px;aspect-ratio:16/9;border-radius:20px;overflow:hidden;box-shadow:0 20px 60px rgba(0,0,0,.4);}
.home-video-container iframe{width:100%;height:100%;border:none;}
.home-posts-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(340px,1fr));gap:22px;}
.home-post-card{background:white;border-radius:18px;overflow:hidden;border:1.5px solid var(--border);box-shadow:0 3px 14px rgba(0,0,0,.05);transition:transform .2s,box-shadow .2s;}
.home-post-card:hover{transform:translateY(-4px);box-shadow:0 12px 32px rgba(0,0,0,.1);}
.hpc-header{background:linear-gradient(135deg,var(--g1),var(--g2));padding:20px 24px 16px;}
.hpc-meta{display:flex;align-items:center;gap:8px;margin-bottom:8px;flex-wrap:wrap;}
.hpc-author{font-size:.73rem;font-weight:700;color:rgba(255,255,255,.9);background:rgba(255,255,255,.2);padding:3px 10px;border-radius:99px;}
.hpc-date{font-size:.73rem;color:rgba(255,255,255,.55);}
.hpc-title{font-family:'Playfair Display',serif;font-size:1.15rem;font-weight:700;color:white;line-height:1.3;}
.hpc-body-wrap{padding:20px 24px 24px;}
.hpc-body{font-size:.92rem;line-height:1.75;color:var(--text);}
.hpc-body p{margin-bottom:.75em;}.hpc-body a{color:var(--g2);}
.hpc-body h3{font-family:'Playfair Display',serif;color:var(--g1);margin:.8em 0 .3em;font-size:1.05rem;}
.hpc-body ul,.hpc-body ol{padding-left:1.4em;margin-bottom:.75em;}

/* TEAM */
.pub-team-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(230px,1fr));gap:22px;}
.pub-team-card{background:white;border-radius:18px;overflow:hidden;border:1.5px solid var(--border);box-shadow:0 4px 18px rgba(0,0,0,.06);transition:transform .2s,box-shadow .2s;}
.pub-team-card:hover{transform:translateY(-4px);box-shadow:0 10px 32px rgba(0,0,0,.1);}
.pub-team-photo{width:100%;height:200px;background-size:cover;background-position:center top;display:flex;align-items:center;justify-content:center;background-color:var(--g5);}
.pub-team-info{padding:18px 20px 20px;}
.pub-team-name{font-family:'Playfair Display',serif;font-size:1.08rem;font-weight:700;color:var(--g1);margin-bottom:3px;}
.pub-team-role{font-size:.78rem;font-weight:700;text-transform:uppercase;letter-spacing:.07em;color:var(--g3);margin-bottom:9px;}
.pub-team-bio{font-size:.87rem;color:var(--muted);line-height:1.6;margin-bottom:11px;}
.pub-team-links{display:flex;flex-wrap:wrap;gap:5px;}
.pub-team-links a{font-size:.75rem;padding:4px 10px;border-radius:8px;background:var(--g6);color:var(--g2);text-decoration:none;font-weight:600;border:1px solid var(--border);transition:all .15s;}
.pub-team-links a:hover{background:var(--g5);color:var(--g1);}

/* RESOURCES */
.pub-res-group{margin-bottom:44px;}
.pub-res-cat{font-family:'Playfair Display',serif;font-size:1.4rem;color:var(--g1);margin-bottom:18px;padding-bottom:10px;border-bottom:2px solid var(--border);}
.pub-res-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:18px;}
.pub-res-card{background:white;border-radius:16px;overflow:hidden;border:1.5px solid var(--border);box-shadow:0 3px 12px rgba(0,0,0,.06);text-decoration:none;color:inherit;display:block;transition:transform .18s,box-shadow .18s;}
.pub-res-card:hover{transform:translateY(-4px);box-shadow:0 8px 28px rgba(0,0,0,.12);border-color:var(--g4);}
.pub-res-img{width:100%;height:130px;background-size:cover;background-position:center;display:flex;align-items:center;justify-content:center;background-color:var(--g5);}
.pub-res-info{padding:14px 16px 16px;}
.pub-res-title{font-family:'Playfair Display',serif;font-size:.98rem;font-weight:700;color:var(--g1);margin-bottom:4px;line-height:1.3;}
.pub-res-desc{font-size:.81rem;color:var(--muted);line-height:1.5;margin-bottom:6px;}
.pub-res-url{font-size:.7rem;color:var(--g3);font-weight:600;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}

/* LOGIN */
#login-overlay{display:none;position:fixed;inset:0;background:rgba(20,50,30,.7);backdrop-filter:blur(8px);align-items:center;justify-content:center;z-index:200;}
#login-overlay.show{display:flex;}
.login-box{background:white;border-radius:24px;padding:40px 36px;width:360px;max-width:92vw;box-shadow:0 24px 70px rgba(0,0,0,.28);border-top:5px solid var(--g3);}
.login-box h2{font-family:'Playfair Display',serif;font-size:1.5rem;color:var(--g1);margin-bottom:6px;}
.login-box .subtitle{font-size:.87rem;color:var(--muted);margin-bottom:20px;line-height:1.5;}
.email-display{background:var(--g6);border:1.5px solid var(--border);border-radius:10px;padding:10px 14px;font-size:.93rem;color:var(--g1);font-weight:500;margin-bottom:12px;}
.login-box input[type=text]{width:100%;padding:11px 14px;border:1.5px solid var(--border);border-radius:10px;font-size:1.1rem;margin-bottom:12px;outline:none;font-family:inherit;transition:border .2s;text-align:center;letter-spacing:.2em;font-weight:600;}
.login-box input:focus{border-color:var(--g3);}
.btn-primary{width:100%;padding:12px;background:linear-gradient(135deg,var(--g2),var(--g3));color:white;border:none;border-radius:10px;font-size:1rem;cursor:pointer;font-weight:600;font-family:inherit;transition:opacity .2s;display:flex;align-items:center;justify-content:center;gap:8px;}
.btn-primary:hover{opacity:.87;}.btn-primary:disabled{opacity:.5;cursor:not-allowed;}
.err{color:#c53030;font-size:.82rem;margin-top:6px;min-height:18px;}
.btn-ghost{width:100%;margin-top:8px;padding:10px;background:none;border:1.5px solid var(--border);border-radius:10px;cursor:pointer;color:var(--muted);font-size:.93rem;font-family:inherit;}
.btn-ghost:hover{background:var(--g6);}
.resend-row{text-align:center;margin-top:12px;font-size:.82rem;color:var(--muted);}
.resend-row a{color:var(--g2);cursor:pointer;text-decoration:underline;}
.remember-row{display:flex;align-items:center;gap:8px;font-size:.84rem;color:var(--muted);margin-bottom:12px;cursor:pointer;}
.remember-row input{width:15px;height:15px;accent-color:var(--g3);cursor:pointer;}
.spinner{width:14px;height:14px;border:2px solid rgba(255,255,255,.4);border-top-color:white;border-radius:50%;animation:spin .7s linear infinite;display:inline-block;}
@keyframes spin{to{transform:rotate(360deg)}}
.hidden{display:none!important;}

/* ADMIN */
#admin-view{display:none;min-height:100vh;background:#f4faf6;}
.admin-topbar{background:var(--g1);color:white;padding:0 32px;height:60px;display:flex;align-items:center;justify-content:space-between;position:sticky;top:0;z-index:50;}
.admin-topbar .brand{font-family:'Playfair Display',serif;font-size:1.1rem;display:flex;align-items:center;gap:10px;}
.admin-badge{background:var(--g3);color:var(--g1);font-family:'DM Sans',sans-serif;font-size:.64rem;font-weight:700;padding:2px 9px;border-radius:99px;letter-spacing:.08em;}
.topbar-btns{display:flex;gap:8px;}
.topbar-btns button{padding:7px 14px;border-radius:9px;font-size:.84rem;cursor:pointer;font-family:inherit;font-weight:500;}
.btn-save-top{background:var(--g3);color:var(--g1);border:none;}.btn-save-top:hover{background:var(--g4);}
.btn-preview-top{background:rgba(255,255,255,.14);color:white;border:1px solid rgba(255,255,255,.28);}.btn-preview-top:hover{background:rgba(255,255,255,.24);}
.btn-logout{background:rgba(255,255,255,.1);color:white;border:1px solid rgba(255,255,255,.18);}.btn-logout:hover{background:rgba(255,255,255,.2);}
.admin-layout{display:flex;height:calc(100vh - 60px);overflow:hidden;}
.admin-sidebar{width:244px;background:white;border-right:1.5px solid var(--border);padding:18px 12px;display:flex;flex-direction:column;gap:3px;overflow-y:auto;flex-shrink:0;}
.sidebar-label{font-size:.68rem;font-weight:700;text-transform:uppercase;letter-spacing:.1em;color:var(--muted);padding:8px 10px 4px;}
.sidebar-btn{display:flex;align-items:center;gap:9px;padding:9px 12px;border-radius:10px;font-size:.87rem;cursor:pointer;border:none;background:none;color:var(--text);font-family:inherit;width:100%;text-align:left;transition:background .15s;}
.sidebar-btn:hover{background:var(--g6);color:var(--g1);}
.sidebar-btn.active{background:var(--g5);color:var(--g1);font-weight:600;}
.sidebar-divider{border:none;border-top:1px solid var(--border);margin:6px 0;}
.page-list-item{display:flex;align-items:center;gap:6px;padding:7px 10px 7px 12px;border-radius:10px;cursor:pointer;border:none;background:none;font-family:inherit;width:100%;text-align:left;font-size:.84rem;color:var(--text);transition:background .15s;}
.page-list-item:hover{background:var(--g6);}.page-list-item.active{background:var(--g5);color:var(--g1);font-weight:600;}
.page-list-item .page-name{flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}
.home-badge{font-size:.59rem;background:var(--g3);color:var(--g1);padding:1px 6px;border-radius:99px;font-weight:700;flex-shrink:0;}
.del-btn{opacity:0;font-size:.74rem;padding:2px 5px;border-radius:4px;background:none;border:none;cursor:pointer;color:#c53030;transition:opacity .15s;}
.page-list-item:hover .del-btn{opacity:1;}
.add-page-btn{display:flex;align-items:center;gap:8px;padding:8px 12px;border-radius:10px;font-size:.84rem;cursor:pointer;border:1.5px dashed var(--border);background:none;color:var(--muted);font-family:inherit;width:100%;text-align:left;transition:all .15s;margin-top:4px;}
.add-page-btn:hover{border-color:var(--g3);color:var(--g2);background:var(--g6);}
.admin-main{flex:1;overflow-y:auto;padding:28px 36px;}
.panel{display:none;}.panel.active{display:block;animation:fadeIn .2s ease;}
@keyframes fadeIn{from{opacity:0;transform:translateY(4px)}to{opacity:1;transform:none}}
.panel-title{font-family:'Playfair Display',serif;font-size:1.4rem;color:var(--g1);margin-bottom:20px;padding-bottom:14px;border-bottom:2px solid var(--border);display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:8px;}
.card{background:white;border-radius:16px;padding:22px 24px;margin-bottom:18px;border:1.5px solid var(--border);box-shadow:0 2px 8px rgba(0,0,0,.04);}
.card label{display:block;font-size:.73rem;font-weight:700;text-transform:uppercase;letter-spacing:.08em;color:var(--muted);margin-bottom:8px;}
.card input[type=text],.card input[type=url]{width:100%;padding:10px 13px;border:1.5px solid var(--border);border-radius:10px;font-size:.96rem;font-family:inherit;outline:none;transition:border .2s;color:var(--text);}
.card input:focus{border-color:var(--g3);}
/* toolbar */
.toolbar{display:flex;flex-wrap:wrap;gap:3px;padding:8px 10px;background:var(--g6);border:1.5px solid var(--border);border-bottom:none;border-radius:10px 10px 0 0;}
.toolbar button{padding:5px 8px;background:white;border:1px solid var(--border);border-radius:6px;font-size:.77rem;cursor:pointer;color:var(--text);font-family:inherit;transition:all .15s;min-width:28px;display:inline-flex;align-items:center;justify-content:center;}
.toolbar button:hover{background:var(--g5);border-color:var(--g3);color:var(--g1);}
.toolbar .sep{width:1px;background:var(--border);margin:0 3px;align-self:stretch;}
.toolbar select{padding:4px 7px;border:1px solid var(--border);border-radius:6px;font-size:.77rem;background:white;cursor:pointer;outline:none;font-family:inherit;}
.editor-area{min-height:320px;padding:16px 18px;border:1.5px solid var(--border);border-top:none;border-radius:0 0 10px 10px;background:white;outline:none;font-family:'DM Sans',sans-serif;font-size:1rem;line-height:1.8;color:var(--text);}
.editor-area:focus{border-color:var(--g3);}
.editor-area h1,.editor-area h2,.editor-area h3{font-family:'Playfair Display',serif;color:var(--g1);margin:.8em 0 .3em;}
.editor-area a{color:var(--g2);}
.editor-area img{max-width:100%;border-radius:10px;margin:8px 0;display:block;}
.editor-area hr{border:none;border-top:2px solid var(--border);margin:1.2em 0;}
.settings-row{display:flex;flex-direction:column;gap:6px;margin-bottom:16px;}
.settings-row label{font-size:.75rem;font-weight:700;text-transform:uppercase;letter-spacing:.07em;color:var(--muted);}
.settings-row input{padding:10px 13px;border:1.5px solid var(--border);border-radius:10px;font-size:.96rem;font-family:inherit;outline:none;transition:border .2s;}
.settings-row input:focus{border-color:var(--g3);}
.save-settings-btn{padding:11px 26px;background:linear-gradient(135deg,var(--g2),var(--g3));color:white;border:none;border-radius:10px;font-size:.93rem;font-weight:600;cursor:pointer;font-family:inherit;}
.save-settings-btn:hover{opacity:.88;}
.confirm-msg{margin-top:10px;font-size:.87rem;font-weight:600;min-height:20px;}
.confirm-msg.ok{color:#276749;}.confirm-msg.bad{color:#c53030;}
/* mini modals */
.mini-modal{display:none;position:fixed;inset:0;background:rgba(20,50,30,.55);backdrop-filter:blur(4px);align-items:center;justify-content:center;z-index:400;}
.mini-modal.show{display:flex;}
.mini-box{background:white;border-radius:20px;padding:26px 24px;width:420px;max-width:95vw;box-shadow:0 20px 60px rgba(0,0,0,.22);border-top:4px solid var(--g3);}
.mini-box h3{font-family:'Playfair Display',serif;font-size:1.22rem;color:var(--g1);margin-bottom:14px;}
.mini-box input{width:100%;padding:10px 13px;margin-bottom:10px;border:1.5px solid var(--border);border-radius:8px;font-size:.94rem;font-family:inherit;outline:none;transition:border .2s;}
.mini-box input:focus{border-color:var(--g3);}
.mini-box .row{display:flex;gap:8px;margin-top:6px;}
.mini-box .row button{flex:1;padding:10px;border-radius:8px;font-size:.9rem;cursor:pointer;border:none;font-family:inherit;font-weight:500;}
.ok-btn{background:linear-gradient(135deg,var(--g2),var(--g3));color:white;font-weight:600;}
.no-btn{background:#eee;color:#555;}
.or-row{display:flex;align-items:center;gap:10px;margin:4px 0 6px;color:var(--muted);font-size:.81rem;}
.or-row::before,.or-row::after{content:'';flex:1;height:1px;background:var(--border);}
.upload-area{border:2px dashed var(--border);border-radius:10px;padding:14px;text-align:center;color:var(--muted);font-size:.84rem;cursor:pointer;transition:all .2s;margin-bottom:10px;}
.upload-area:hover{border-color:var(--g3);background:var(--g6);color:var(--g2);}
/* template grid */
.tpl-card{border:2px solid var(--border);border-radius:14px;padding:13px 14px;cursor:pointer;transition:all .15s;background:white;text-align:left;font-family:inherit;width:100%;}
.tpl-card:hover{border-color:var(--g3);background:var(--g6);}.tpl-card.selected{border-color:var(--g3);background:var(--g5);box-shadow:0 0 0 3px rgba(61,166,106,.2);}
.tpl-icon{font-size:1.4rem;margin-bottom:6px;display:block;}
.tpl-name{font-size:.86rem;font-weight:700;color:var(--g1);display:block;margin-bottom:2px;}
.tpl-desc{font-size:.74rem;color:var(--muted);line-height:1.4;display:block;}
/* team editor */
.team-member-card{background:white;border:1.5px solid var(--border);border-radius:16px;margin-bottom:14px;overflow:hidden;box-shadow:0 2px 8px rgba(0,0,0,.04);}
.team-card-header{background:var(--g6);border-bottom:1.5px solid var(--border);padding:9px 15px;display:flex;align-items:center;justify-content:space-between;}
.team-card-num{font-size:.76rem;font-weight:700;text-transform:uppercase;letter-spacing:.07em;color:var(--muted);}
.ctrl-btn{background:white;border:1px solid var(--border);border-radius:6px;padding:4px 9px;cursor:pointer;font-size:.77rem;color:var(--text);transition:all .15s;}
.ctrl-btn:hover{background:var(--g5);border-color:var(--g3);}
.team-card-body{display:flex;gap:18px;padding:18px;flex-wrap:wrap;}
.team-photo-col{display:flex;flex-direction:column;align-items:center;width:115px;flex-shrink:0;}
.team-photo-preview{width:108px;height:108px;border-radius:50%;border:2px solid var(--border);background-size:cover;background-position:center;display:flex;align-items:center;justify-content:center;overflow:hidden;background-color:var(--g6);font-size:2.3rem;}
.upload-btn-sm{flex:1;padding:5px 4px;border:1px solid var(--border);border-radius:7px;font-size:.7rem;cursor:pointer;background:white;color:var(--text);font-family:inherit;transition:all .15s;text-align:center;}
.upload-btn-sm:hover{background:var(--g5);border-color:var(--g3);}
.tm-fields{flex:1;min-width:200px;display:flex;flex-direction:column;gap:9px;}
.tm-group{display:flex;flex-direction:column;gap:4px;}
.tm-lbl{font-size:.7rem;font-weight:700;text-transform:uppercase;letter-spacing:.07em;color:var(--muted);}
.tm-in{padding:8px 11px;border:1.5px solid var(--border);border-radius:8px;font-size:.91rem;font-family:inherit;outline:none;transition:border .2s;color:var(--text);}
.tm-in:focus{border-color:var(--g3);}
.tm-ta{padding:8px 11px;border:1.5px solid var(--border);border-radius:8px;font-size:.91rem;font-family:inherit;outline:none;transition:border .2s;resize:vertical;color:var(--text);line-height:1.5;}
.tm-ta:focus{border-color:var(--g3);}
.add-link-btn{background:none;border:1px solid var(--border);border-radius:6px;padding:3px 9px;cursor:pointer;font-size:.73rem;color:var(--muted);font-family:inherit;}
.add-link-btn:hover{background:var(--g5);border-color:var(--g3);color:var(--g1);}
/* resource editor */
.res-card{background:white;border:1.5px solid var(--border);border-radius:14px;margin-bottom:12px;overflow:hidden;}
.res-card-hdr{background:var(--g6);border-bottom:1.5px solid var(--border);padding:8px 14px;display:flex;align-items:center;justify-content:space-between;}
.res-card-body{display:flex;gap:16px;padding:16px;flex-wrap:wrap;}
.res-img-col{display:flex;flex-direction:column;align-items:center;width:105px;flex-shrink:0;}
.res-img-prev{width:95px;height:68px;border-radius:9px;border:2px solid var(--border);background-size:cover;background-position:center;display:flex;align-items:center;justify-content:center;background-color:var(--g6);font-size:1.6rem;overflow:hidden;}
.res-fields{flex:1;min-width:190px;display:flex;flex-direction:column;gap:8px;}
/* home feature card editor */
.fc-row{background:var(--g6);border:1.5px solid var(--border);border-radius:14px;padding:16px;margin-bottom:10px;}
.fc-top{display:flex;gap:10px;align-items:flex-start;}
.fc-icon-in{width:50px;text-align:center;font-size:1.4rem;padding:6px;border:1.5px solid var(--border);border-radius:8px;background:white;font-family:inherit;outline:none;}
.fc-icon-in:focus{border-color:var(--g3);}
.fc-right{flex:1;display:flex;flex-direction:column;gap:7px;}
.fc-btns{display:flex;flex-direction:column;gap:4px;}
/* post editor body */
#post-editor-body{min-height:200px;max-height:360px;overflow-y:auto;padding:13px 15px;border:1.5px solid var(--border);border-top:none;border-radius:0 0 10px 10px;background:white;outline:none;font-family:'DM Sans',sans-serif;font-size:.94rem;line-height:1.7;}
/* toast & preview banner */
#save-toast{position:fixed;bottom:24px;left:50%;transform:translateX(-50%) translateY(20px);background:var(--g1);color:white;padding:11px 26px;border-radius:99px;font-size:.88rem;font-weight:500;opacity:0;transition:all .3s;pointer-events:none;z-index:999;box-shadow:0 8px 30px rgba(0,0,0,.2);}
#save-toast.show{opacity:1;transform:translateX(-50%) translateY(0);}
#preview-banner{display:none;position:fixed;bottom:0;left:0;right:0;z-index:100;background:var(--g1);color:white;padding:12px 24px;align-items:center;justify-content:space-between;box-shadow:0 -4px 20px rgba(0,0,0,.2);}
#preview-banner .preview-info{display:flex;align-items:center;gap:10px;font-size:.88rem;}
.preview-badge{background:var(--g3);color:var(--g1);font-size:.69rem;font-weight:700;padding:2px 9px;border-radius:99px;text-transform:uppercase;letter-spacing:.06em;}
#preview-banner button{background:var(--g3);color:var(--g1);border:none;padding:8px 18px;border-radius:99px;font-weight:700;cursor:pointer;font-family:inherit;font-size:.86rem;}
@media(max-width:640px){.pub-nav{padding:0 16px;}.pub-hero{padding:80px 20px 80px;}.home-section-wrap{padding:0 16px;}.pub-content{padding:40px 20px 60px;}.admin-main{padding:16px;}.admin-topbar{padding:0 16px;}}

/* EVENTS PUBLIC */
.pub-events-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:24px;}
.pub-event-card{background:white;border-radius:18px;overflow:hidden;border:1.5px solid var(--border);box-shadow:0 4px 18px rgba(0,0,0,.06);transition:transform .2s,box-shadow .2s;}
.pub-event-card:hover{transform:translateY(-4px);box-shadow:0 12px 32px rgba(0,0,0,.1);}
.pub-event-img{width:100%;height:200px;background-size:cover;background-position:center;background-color:var(--g5);display:flex;align-items:center;justify-content:center;font-size:3rem;}
.pub-event-body{padding:20px 22px 22px;}
.pub-event-date{font-size:.75rem;font-weight:700;text-transform:uppercase;letter-spacing:.1em;color:var(--g3);margin-bottom:7px;}
.pub-event-title{font-family:'Playfair Display',serif;font-size:1.2rem;font-weight:700;color:var(--g1);margin-bottom:8px;line-height:1.3;}
.pub-event-desc{font-size:.88rem;color:var(--muted);line-height:1.6;margin-bottom:10px;}
.pub-event-location{font-size:.8rem;color:var(--muted);display:flex;align-items:center;gap:5px;margin-bottom:14px;}
.pub-event-link{display:inline-block;padding:9px 20px;background:linear-gradient(135deg,var(--g2),var(--g3));color:white;text-decoration:none;border-radius:99px;font-size:.85rem;font-weight:600;transition:opacity .2s;}
.pub-event-link:hover{opacity:.85;}

/* â”€â”€ BUILD BLOG â”€â”€ */
.pub-bb-list{display:flex;flex-direction:column;gap:32px;}
.pub-bb-entry{background:white;border-radius:18px;border:1.5px solid var(--border);overflow:hidden;box-shadow:0 3px 14px rgba(0,0,0,.05);}
.pub-bb-header{background:linear-gradient(135deg,var(--g1),var(--g2));padding:18px 24px;}
.pub-bb-week{font-size:.7rem;font-weight:700;text-transform:uppercase;letter-spacing:.12em;color:var(--g4);margin-bottom:4px;}
.pub-bb-title{font-family:'Playfair Display',serif;font-size:1.2rem;font-weight:700;color:white;}
.pub-bb-date{font-size:.75rem;color:rgba(255,255,255,.55);margin-top:3px;}
.pub-bb-body{padding:20px 24px;font-size:.95rem;line-height:1.8;color:var(--text);}
.pub-bb-body p{margin-bottom:.8em;}.pub-bb-body h3{font-family:'Playfair Display',serif;color:var(--g1);margin:.8em 0 .3em;}
.pub-bb-body ul,.pub-bb-body ol{padding-left:1.5em;margin-bottom:.8em;}
.pub-bb-body a{color:var(--g2);}
.pub-bb-imgs{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:10px;padding:0 24px 22px;}
.pub-bb-img{width:100%;aspect-ratio:4/3;object-fit:cover;border-radius:10px;border:1px solid var(--border);}
.pub-bb-tags{padding:0 24px 18px;display:flex;gap:6px;flex-wrap:wrap;}
.pub-bb-tag{font-size:.71rem;font-weight:700;padding:3px 10px;border-radius:99px;background:var(--g5);color:var(--g1);border:1px solid var(--border);}

/* â”€â”€ MATCH VIDEOS â”€â”€ */
.pub-mv-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:22px;}
.pub-mv-card{background:white;border-radius:18px;overflow:hidden;border:1.5px solid var(--border);box-shadow:0 3px 14px rgba(0,0,0,.05);transition:transform .2s,box-shadow .2s;}
.pub-mv-card:hover{transform:translateY(-3px);box-shadow:0 10px 28px rgba(0,0,0,.1);}
.pub-mv-embed{position:relative;aspect-ratio:16/9;background:var(--g1);}
.pub-mv-embed iframe{width:100%;height:100%;border:none;}
.pub-mv-thumb{width:100%;height:100%;background-size:cover;background-position:center;display:flex;align-items:center;justify-content:center;cursor:pointer;position:relative;}
.pub-mv-play{width:52px;height:52px;background:rgba(255,255,255,.92);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1.3rem;box-shadow:0 2px 12px rgba(0,0,0,.3);transition:transform .2s;}
.pub-mv-thumb:hover .pub-mv-play{transform:scale(1.1);}
.pub-mv-info{padding:16px 18px 18px;}
.pub-mv-event{font-size:.7rem;font-weight:700;text-transform:uppercase;letter-spacing:.1em;color:var(--g3);margin-bottom:4px;}
.pub-mv-match{font-family:'Playfair Display',serif;font-size:1.05rem;font-weight:700;color:var(--g1);margin-bottom:6px;}
.pub-mv-notes{font-size:.84rem;color:var(--muted);line-height:1.55;}

/* â”€â”€ COMP SCHEDULE â”€â”€ */
.pub-cs-season{font-size:.75rem;font-weight:700;text-transform:uppercase;letter-spacing:.12em;color:var(--g3);margin-bottom:18px;}
.pub-cs-list{display:flex;flex-direction:column;gap:16px;}
.pub-cs-card{background:white;border-radius:16px;border:1.5px solid var(--border);overflow:hidden;box-shadow:0 2px 10px rgba(0,0,0,.05);display:flex;gap:0;transition:transform .18s,box-shadow .18s;}
.pub-cs-card:hover{transform:translateY(-3px);box-shadow:0 8px 24px rgba(0,0,0,.1);}
.pub-cs-status-bar{width:6px;flex-shrink:0;}
.pub-cs-status-bar.upcoming{background:var(--g3);}
.pub-cs-status-bar.past{background:var(--muted);}
.pub-cs-status-bar.active{background:#f59e0b;}
.pub-cs-img{width:120px;flex-shrink:0;background-size:cover;background-position:center;background-color:var(--g5);display:flex;align-items:center;justify-content:center;font-size:2rem;}
.pub-cs-body{padding:16px 20px;flex:1;}
.pub-cs-badge{display:inline-block;font-size:.65rem;font-weight:700;text-transform:uppercase;letter-spacing:.08em;padding:2px 9px;border-radius:99px;margin-bottom:7px;}
.pub-cs-badge.upcoming{background:#dcfce7;color:#166534;}
.pub-cs-badge.past{background:#f1f5f9;color:#64748b;}
.pub-cs-badge.active{background:#fef3c7;color:#92400e;}
.pub-cs-name{font-family:'Playfair Display',serif;font-size:1.1rem;font-weight:700;color:var(--g1);margin-bottom:4px;}
.pub-cs-date{font-size:.82rem;color:var(--muted);margin-bottom:4px;}
.pub-cs-location{font-size:.82rem;color:var(--muted);margin-bottom:8px;}
.pub-cs-record{font-size:.82rem;font-weight:600;color:var(--g2);}
.pub-cs-link{display:inline-block;margin-top:8px;font-size:.78rem;font-weight:700;color:var(--g2);text-decoration:none;padding:4px 12px;border-radius:99px;border:1.5px solid var(--border);transition:all .15s;}
.pub-cs-link:hover{background:var(--g5);border-color:var(--g3);}

/* â”€â”€ ROBOT SHOWCASE â”€â”€ */
.pub-rs-hero{display:flex;gap:36px;align-items:flex-start;flex-wrap:wrap;margin-bottom:44px;}
.pub-rs-mainimg{width:420px;max-width:100%;border-radius:20px;overflow:hidden;border:2px solid var(--border);box-shadow:0 8px 32px rgba(0,0,0,.12);flex-shrink:0;background:var(--g5);aspect-ratio:4/3;background-size:cover;background-position:center;display:flex;align-items:center;justify-content:center;font-size:4rem;}
.pub-rs-info{flex:1;min-width:260px;}
.pub-rs-year{font-size:.7rem;font-weight:700;text-transform:uppercase;letter-spacing:.14em;color:var(--g3);margin-bottom:6px;}
.pub-rs-rname{font-family:'Playfair Display',serif;font-size:2.2rem;font-weight:900;color:var(--g1);line-height:1.1;margin-bottom:10px;}
.pub-rs-tagline{font-size:1.05rem;color:var(--muted);line-height:1.6;margin-bottom:22px;}
.pub-rs-specs{display:grid;grid-template-columns:repeat(auto-fill,minmax(130px,1fr));gap:12px;}
.pub-rs-spec{background:var(--g6);border-radius:12px;padding:14px 16px;border:1.5px solid var(--border);}
.pub-rs-spec-label{font-size:.66rem;font-weight:700;text-transform:uppercase;letter-spacing:.1em;color:var(--g3);margin-bottom:4px;}
.pub-rs-spec-val{font-size:1rem;font-weight:700;color:var(--g1);}
.pub-rs-features{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:18px;margin-bottom:36px;}
.pub-rs-feat{background:white;border-radius:16px;border:1.5px solid var(--border);overflow:hidden;box-shadow:0 2px 10px rgba(0,0,0,.05);}
.pub-rs-feat-img{width:100%;height:170px;background-size:cover;background-position:center;background-color:var(--g5);display:flex;align-items:center;justify-content:center;font-size:2.5rem;}
.pub-rs-feat-body{padding:14px 16px 16px;}
.pub-rs-feat-title{font-family:'Playfair Display',serif;font-size:1rem;font-weight:700;color:var(--g1);margin-bottom:5px;}
.pub-rs-feat-desc{font-size:.86rem;color:var(--muted);line-height:1.6;}
.pub-rs-gallery{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:12px;}
.pub-rs-gallery-img{width:100%;aspect-ratio:4/3;object-fit:cover;border-radius:12px;border:1.5px solid var(--border);}

/* â”€â”€ LIVESTREAM â”€â”€ */
.pub-ls-wrap{max-width:960px;margin:0 auto;}
.pub-ls-live-badge{display:inline-flex;align-items:center;gap:7px;background:#dc2626;color:white;font-size:.72rem;font-weight:800;text-transform:uppercase;letter-spacing:.12em;padding:5px 14px;border-radius:99px;margin-bottom:18px;}
.pub-ls-live-dot{width:8px;height:8px;border-radius:50%;background:white;animation:ls-pulse 1.2s ease-in-out infinite;}
@keyframes ls-pulse{0%,100%{opacity:1;transform:scale(1)}50%{opacity:.4;transform:scale(0.7)}}
.pub-ls-embed-wrap{position:relative;width:100%;aspect-ratio:16/9;border-radius:18px;overflow:hidden;background:#000;box-shadow:0 12px 48px rgba(0,0,0,.28);margin-bottom:16px;}
.pub-ls-embed-wrap iframe{position:absolute;inset:0;width:100%;height:100%;border:none;}
.pub-ls-with-chat{display:grid;grid-template-columns:1fr 360px;gap:16px;align-items:start;}
.pub-ls-chat-wrap{aspect-ratio:9/16;border-radius:18px;overflow:hidden;border:1.5px solid var(--border);background:#000;max-height:540px;}
.pub-ls-chat-wrap iframe{width:100%;height:100%;border:none;}
@media(max-width:860px){.pub-ls-with-chat{grid-template-columns:1fr;}.pub-ls-chat-wrap{aspect-ratio:16/6;max-height:220px;}}
.pub-ls-soon-card{background:linear-gradient(135deg,var(--g1),var(--g2));border-radius:20px;padding:48px 36px;text-align:center;color:white;box-shadow:0 10px 40px rgba(0,0,0,.18);}
.pub-ls-soon-icon{font-size:3.5rem;margin-bottom:16px;}
.pub-ls-soon-label{font-size:.72rem;font-weight:700;text-transform:uppercase;letter-spacing:.14em;color:var(--g4);margin-bottom:10px;}
.pub-ls-soon-time{font-family:'Playfair Display',serif;font-size:1.9rem;font-weight:900;margin-bottom:10px;line-height:1.2;}
.pub-ls-soon-desc{font-size:1rem;color:rgba(255,255,255,.7);margin-bottom:24px;}
.pub-ls-soon-hint{font-size:.78rem;color:rgba(255,255,255,.4);}
.pub-ls-offline-card{border-radius:20px;overflow:hidden;position:relative;min-height:260px;display:flex;align-items:center;justify-content:center;text-align:center;background:var(--g1);}
.pub-ls-offline-bg{position:absolute;inset:0;background-size:cover;background-position:center;opacity:.22;}
.pub-ls-offline-inner{position:relative;z-index:1;padding:48px 32px;color:white;}
.pub-ls-offline-icon{font-size:3rem;margin-bottom:14px;}
.pub-ls-offline-msg{font-size:1.1rem;color:rgba(255,255,255,.8);max-width:400px;line-height:1.7;}
.pub-ls-past-section{margin-top:40px;}
.pub-ls-past-heading{font-family:'Playfair Display',serif;color:var(--g1);font-size:1.3rem;font-weight:700;margin-bottom:18px;}
.pub-ls-past-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:16px;}
.pub-ls-past-card{background:white;border-radius:14px;overflow:hidden;border:1.5px solid var(--border);box-shadow:0 2px 10px rgba(0,0,0,.05);transition:transform .2s,box-shadow .2s;}
.pub-ls-past-card:hover{transform:translateY(-3px);box-shadow:0 8px 24px rgba(0,0,0,.1);}
.pub-ls-past-thumb{width:100%;aspect-ratio:16/9;background:var(--g1);background-size:cover;background-position:center;display:flex;align-items:center;justify-content:center;font-size:1.8rem;cursor:pointer;position:relative;}
.pub-ls-past-play{position:absolute;width:44px;height:44px;background:rgba(255,255,255,.9);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1.1rem;box-shadow:0 2px 10px rgba(0,0,0,.25);}
.pub-ls-past-info{padding:14px 16px;}
.pub-ls-past-event{font-size:.68rem;font-weight:700;text-transform:uppercase;letter-spacing:.1em;color:var(--g3);margin-bottom:4px;}
.pub-ls-past-title{font-size:.95rem;font-weight:700;color:var(--g1);margin-bottom:4px;}
.pub-ls-past-date{font-size:.78rem;color:var(--muted);}
/* status button active state */
.ls-status-active{background:var(--g1)!important;color:white!important;border-color:var(--g1)!important;}
</style>
</head>
<body>

<!-- PREVIEW BANNER -->
<div id="preview-banner">
  <div class="preview-info"><span class="preview-badge">Preview Mode</span> Viewing as a visitor</div>
  <button onclick="exitPreview()">â† Back to Editor</button>
</div>

<!-- PUBLIC VIEW -->
<div id="public-view">
  <nav class="pub-nav">
    <a class="logo" id="pub-logo-text" onclick="navigateTo('home')">My <span>Site</span></a>
    <div class="pub-nav-right">
      <div class="pub-nav-links" id="pub-nav-links"></div>
      <button id="admin-mode-btn" onclick="switchToAdminMode()">âš™ Admin</button>
    </div>
  </nav>
  <header class="pub-hero" id="pub-hero">
    <div class="hero-inner">
      <div id="pub-title">Welcome</div>
      <div id="pub-subtitle"></div>
    </div>
  </header>
  <main class="pub-content" id="pub-generic-content">
    <div class="page-content-area" id="pub-body-content"></div>
  </main>
  <div id="pub-home-content" style="display:none">
    <div class="home-posts-section" id="pub-posts-wrap" style="display:none">
      <div class="home-section-wrap">
        <div class="home-section-label" id="pub-posts-label">Updates</div>
        <h2 class="home-section-heading" id="pub-posts-heading">Recent Posts</h2>
        <div class="home-posts-grid" id="pub-posts"></div>
      </div>
    </div>
    <div class="home-features-section" id="pub-features" style="display:none"></div>
    <div class="home-video-section" id="pub-video-wrap" style="display:none">
      <div class="home-section-wrap">
        <div class="home-section-label" id="pub-video-label">Watch</div>
        <h2 class="home-section-heading" id="pub-video-heading">Featured Video</h2>
        <div class="home-video-container" id="pub-video"></div>
      </div>
    </div>
    <div class="home-gallery-section" id="pub-gallery-wrap" style="display:none">
      <div class="home-section-wrap">
        <div class="home-section-label">Gallery</div>
        <h2 class="home-section-heading" id="pub-gallery-heading">Photos</h2>
        <div class="home-gallery-grid" id="pub-gallery"></div>
      </div>
    </div>
  </div>
  <footer class="pub-footer"><div id="pub-footer-text">Â© 2025 My Website</div></footer>
</div>

<!-- SECRET ADMIN BUTTON -->
<button id="admin-link" onclick="showLogin()">âš™ admin</button>

<!-- LOGIN -->
<div id="login-overlay">
  <div class="login-box">
    <div id="step-send">
      <h2>ğŸŒ¿ Admin Login</h2>
      <p class="subtitle">We'll email you a 6-digit code.</p>
      <div class="email-display">ğŸ“§ zavien.786@gmail.com</div>
      <label class="remember-row"><input type="checkbox" id="remember-me-chk"> Stay logged in for 30 days</label>
      <button class="btn-primary" id="send-btn" onclick="sendCode()">Send Verification Code</button>
      <div class="err" id="send-err"></div>
      <button class="btn-ghost" onclick="hideLogin()">Cancel</button>
    </div>
    <div id="step-verify" class="hidden">
      <h2>ğŸŒ¿ Check Your Email</h2>
      <p class="subtitle">Enter the 6-digit code sent to<br><strong>zavien.786@gmail.com</strong></p>
      <input type="text" id="code-input" maxlength="6" placeholder="000000"
        oninput="this.value=this.value.replace(/\D/g,'')"
        onkeydown="if(event.key==='Enter')verifyCode()">
      <button class="btn-primary" onclick="verifyCode()">Verify &amp; Sign In</button>
      <div class="err" id="verify-err"></div>
      <div class="resend-row">Didn't get it? <a onclick="resendCode()">Resend</a> &nbsp;Â·&nbsp; <a onclick="backToSend()">Go back</a></div>
    </div>
  </div>
</div>

<!-- ADMIN VIEW -->
<div id="admin-view">
  <div class="admin-topbar">
    <div class="brand">ğŸŒ¿ My Website <span class="admin-badge">Admin</span></div>
    <div class="topbar-btns">
      <button class="btn-save-top" onclick="saveAll()">ğŸ’¾ Save &amp; Publish</button>
      <button class="btn-preview-top" onclick="enterPreview()">ğŸ‘ Preview</button>
      <button class="btn-preview-top" onclick="logout()">&#8592; Back to Site</button><button class="btn-logout" onclick="logoutAdmin()">Sign Out</button>
    </div>
  </div>
  <div class="admin-layout">
    <div class="admin-sidebar">
      <div class="sidebar-label">Pages</div>
      <div id="page-list"></div>
      <button class="add-page-btn" onclick="openNewPageModal()">ï¼‹ Add New Page</button>
      <hr class="sidebar-divider">
      <div class="sidebar-label">Site</div>
      <button class="sidebar-btn" data-panel="settings" onclick="switchToSettings()">âš™ï¸ Settings</button>
    </div>
    <div class="admin-main" id="admin-main">
      <div class="panel active" id="panel-page">
        <div class="panel-title">
          <span><span id="editing-page-name">Home</span>
          <button style="background:none;border:none;cursor:pointer;font-size:.8rem;color:var(--muted);padding:3px 8px;border-radius:5px;margin-left:6px;transition:all .15s;" onmouseover="this.style.background='var(--g6)'" onmouseout="this.style.background='none'" onclick="openRenameModal()">âœï¸ Rename</button></span>
          <button class="btn-ghost" id="delete-page-btn" onclick="deleteCurrentPage()" style="display:none;background:#fff0f0;color:#c53030;border-color:#fcc;max-width:120px;padding:7px 14px;font-size:.83rem;font-weight:600;">ğŸ—‘ Delete</button>
        </div>
        <div class="card">
          <label>Hero Headline</label>
          <input type="text" id="hero-title" placeholder="Your big headline">
          <br><br>
          <label>Hero Subtitle</label>
          <input type="text" id="hero-subtitle" placeholder="A tagline or description" style="margin-top:4px">
        </div>
        <div id="rich-editor-wrap">
        <div class="card">
          <label>Page Content</label>
          <div class="toolbar">
            <select onchange="execCmd('formatBlock',this.value);this.selectedIndex=0;">
              <option value="" disabled selected>Styleâ€¦</option>
              <option value="p">Paragraph</option><option value="h1">H1</option>
              <option value="h2">H2</option><option value="h3">H3</option>
              <option value="blockquote">Quote</option>
            </select>
            <div class="sep"></div>
            <button onclick="execCmd('bold')"><b>B</b></button>
            <button onclick="execCmd('italic')"><i>I</i></button>
            <button onclick="execCmd('underline')"><u>U</u></button>
            <button onclick="execCmd('strikeThrough')"><s>S</s></button>
            <div class="sep"></div>
            <button onclick="execCmd('insertUnorderedList')">â€¢ List</button>
            <button onclick="execCmd('insertOrderedList')">1. List</button>
            <div class="sep"></div>
            <button onclick="execCmd('justifyLeft')">â¬…</button>
            <button onclick="execCmd('justifyCenter')">â¬›</button>
            <button onclick="execCmd('justifyRight')">â¡</button>
            <div class="sep"></div>
            <button onclick="openLinkModal()">ğŸ”— Link</button>
            <button onclick="openImageModal()">ğŸ–¼ Img</button>
            <button onclick="insertHR()">â€” Rule</button>
            <div class="sep"></div>
            <button onclick="execCmd('undo')">â†©</button>
            <button onclick="execCmd('redo')">â†ª</button>
          </div>
          <div class="editor-area" id="editor" contenteditable="true" spellcheck="true"></div>
        </div>
        </div>
        <div id="canvas-editor-wrap" style="display:none">
        <div class="card">
          <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:12px;flex-wrap:wrap;gap:8px">
            <label style="margin:0">ğŸ¨ Canvas</label>
            <div style="display:flex;gap:6px">
              <button class="upload-btn-sm" style="width:auto;padding:5px 10px" onclick="addCEl('text')">ï¼‹ Text</button>
              <button class="upload-btn-sm" style="width:auto;padding:5px 10px" onclick="addCEl('heading')">ï¼‹ Heading</button>
              <button class="upload-btn-sm" style="width:auto;padding:5px 10px" onclick="addCEl('box')">ï¼‹ Shape</button>
              <button class="upload-btn-sm" style="width:auto;padding:5px 10px" onclick="addCEl('image')">ï¼‹ Image</button>
            </div>
          </div>
          <div id="canvas-stage" style="position:relative;width:100%;min-height:480px;background:white;border:1.5px solid var(--border);border-radius:10px;overflow:hidden"></div>
        </div>
        </div>
        <div id="team-editor-wrap" style="display:none">
        <div class="card">
          <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:12px">
            <label style="margin:0">ğŸ‘¥ Team Members</label>
            <button class="upload-btn-sm" style="width:auto;padding:5px 10px" onclick="addTeamMember()">ï¼‹ Add Member</button>
          </div>
          <div id="team-member-list"></div>
        </div>
        </div>
        <div id="resources-editor-wrap" style="display:none">
        <div class="card">
          <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:12px">
            <label style="margin:0">ğŸ“š Resources</label>
            <button class="upload-btn-sm" style="width:auto;padding:5px 10px" onclick="addResource()">ï¼‹ Add Resource</button>
          </div>
          <div id="resource-list"></div>
        </div>
        </div>
        <div id="events-editor-wrap" style="display:none">
        <div class="card">
          <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:12px">
            <label style="margin:0">ğŸ‰ Events</label>
            <button class="upload-btn-sm" style="width:auto;padding:5px 10px" onclick="addEvent()">ï¼‹ Add Event</button>
          </div>
          <p style="font-size:.77rem;color:var(--muted);margin-bottom:14px">Each event can have a date, title, description, location, photo, and a link with custom button label.</p>
          <div id="events-list"></div>
        </div>
        </div>
        <div id="buildblog-editor-wrap" style="display:none">
        <div class="card">
          <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:12px">
            <label style="margin:0">ğŸ”§ Build Season Blog</label>
            <button class="upload-btn-sm" style="width:auto;padding:5px 10px" onclick="addBuildPost()">ï¼‹ Add Update</button>
          </div>
          <p style="font-size:.77rem;color:var(--muted);margin-bottom:14px">Post weekly build updates. Each entry has a week label, date, title, rich text body, and up to 4 photos.</p>
          <div id="buildblog-list"></div>
        </div>
        </div>
        <div id="matchvideos-editor-wrap" style="display:none">
        <div class="card">
          <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:12px">
            <label style="margin:0">ğŸ¥ Match Videos</label>
            <button class="upload-btn-sm" style="width:auto;padding:5px 10px" onclick="addMatchVideo()">ï¼‹ Add Video</button>
          </div>
          <p style="font-size:.77rem;color:var(--muted);margin-bottom:14px">Paste YouTube/Vimeo match links. Add event name, match number, and notes.</p>
          <div id="matchvideos-list"></div>
        </div>
        </div>
        <div id="compschedule-editor-wrap" style="display:none">
        <div class="card">
          <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:12px">
            <label style="margin:0">ğŸ“† Competition Schedule</label>
            <button class="upload-btn-sm" style="width:auto;padding:5px 10px" onclick="addCompEvent()">ï¼‹ Add Competition</button>
          </div>
          <div style="display:flex;gap:10px;margin-bottom:14px;flex-wrap:wrap">
            <div style="flex:1;min-width:120px"><label style="font-size:.72rem;font-weight:700;text-transform:uppercase;letter-spacing:.07em;color:var(--muted);display:block;margin-bottom:4px">Season</label>
            <input type="text" id="cs-season" placeholder="e.g. 2025-2026" class="tm-in" style="width:100%"></div>
          </div>
          <div id="compschedule-list"></div>
        </div>
        </div>
        <div id="robotshowcase-editor-wrap" style="display:none">
        <div class="card">
          <label>ğŸ¤– Robot Info</label>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:16px">
            <div><label class="tm-lbl">Robot Name</label><input type="text" id="rs-name" class="tm-in" placeholder="e.g. Ironclad"></div>
            <div><label class="tm-lbl">Year</label><input type="text" id="rs-year" class="tm-in" placeholder="2026"></div>
            <div style="grid-column:1/-1"><label class="tm-lbl">Tagline</label><input type="text" id="rs-tagline" class="tm-in" placeholder="One-line description of the robot"></div>
          </div>
          <label class="tm-lbl">Main Robot Photo</label>
          <div style="display:flex;gap:8px;align-items:center;margin-bottom:16px">
            <div id="rs-main-img-prev" style="width:80px;height:60px;border-radius:8px;border:2px solid var(--border);background-size:cover;background-position:center;background-color:var(--g6);display:flex;align-items:center;justify-content:center;font-size:1.4rem;flex-shrink:0">ğŸ¤–</div>
            <div style="display:flex;flex-direction:column;gap:5px">
              <button class="upload-btn-sm" style="width:auto;padding:5px 12px" onclick="document.getElementById('rs-main-file').click()">ğŸ“ Upload</button>
              <button class="upload-btn-sm" style="width:auto;padding:5px 12px" onclick="setRsMainUrl()">ğŸ”— URL</button>
              <input type="file" id="rs-main-file" accept="image/*" style="display:none" onchange="handleRsMainPhoto(event)">
              <input type="hidden" id="rs-main-img">
            </div>
          </div>
          <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:8px">
            <label class="tm-lbl" style="margin:0">Specs</label>
            <button class="upload-btn-sm" style="width:auto;padding:4px 10px" onclick="addRsSpec()">ï¼‹ Spec</button>
          </div>
          <div id="rs-specs-list" style="margin-bottom:16px"></div>
          <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:8px">
            <label class="tm-lbl" style="margin:0">Feature Highlights</label>
            <button class="upload-btn-sm" style="width:auto;padding:4px 10px" onclick="addRsFeature()">ï¼‹ Feature</button>
          </div>
          <div id="rs-features-list" style="margin-bottom:16px"></div>
          <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:8px">
            <label class="tm-lbl" style="margin:0">Photo Gallery</label>
            <button class="upload-btn-sm" style="width:auto;padding:4px 10px" onclick="addRsGalleryPhoto()">ï¼‹ Photo</button>
          </div>
          <div id="rs-gallery-list"></div>
        </div>
        </div>
        <div id="livestream-editor-wrap" style="display:none">
        <div class="card">
          <label>ğŸ“¡ Livestream Settings</label>
          <p style="font-size:.77rem;color:var(--muted);margin-bottom:16px">Control what visitors see on this page â€” a live stream, an "upcoming" notice, or an offline message.</p>
          <label class="tm-lbl">Stream Status</label>
          <div style="display:flex;gap:8px;margin-bottom:16px;flex-wrap:wrap">
            <button id="ls-status-live"    class="upload-btn-sm" onclick="setLsStatus('live')"      style="padding:6px 14px">ğŸ”´ Live Now</button>
            <button id="ls-status-soon"    class="upload-btn-sm" onclick="setLsStatus('soon')"      style="padding:6px 14px">ğŸŸ¡ Coming Soon</button>
            <button id="ls-status-offline" class="upload-btn-sm" onclick="setLsStatus('offline')"   style="padding:6px 14px">âš« Offline</button>
          </div>
          <div id="ls-live-fields">
            <label class="tm-lbl">YouTube / Twitch Live URL</label>
            <input type="url" id="ls-stream-url" class="tm-in" placeholder="https://youtube.com/watch?v=LIVE_ID or https://twitch.tv/yourchannel" style="width:100%;margin-bottom:10px">
            <label class="tm-lbl">Live Chat URL (optional)</label>
            <input type="url" id="ls-chat-url" class="tm-in" placeholder="https://youtube.com/live_chat?v=LIVE_ID&embed_domain=yourdomain.com" style="width:100%;margin-bottom:4px">
            <p style="font-size:.72rem;color:var(--muted);margin-bottom:14px">YouTube chat embed requires your site to be hosted. Leave blank to hide chat.</p>
          </div>
          <div id="ls-soon-fields">
            <label class="tm-lbl">Scheduled Date & Time</label>
            <input type="text" id="ls-scheduled-time" class="tm-in" placeholder="Saturday March 8, 2026 Â· 9:00 AM EST" style="width:100%;margin-bottom:10px">
            <label class="tm-lbl">Event Description</label>
            <input type="text" id="ls-scheduled-desc" class="tm-in" placeholder="e.g. State Regional â€” Qualification Matches" style="width:100%;margin-bottom:10px">
          </div>
          <div id="ls-offline-fields">
            <label class="tm-lbl">Offline Message</label>
            <input type="text" id="ls-offline-msg" class="tm-in" placeholder="No stream currently live. Check back during competitions!" style="width:100%;margin-bottom:10px">
            <label class="tm-lbl">Offline Background Image (optional)</label>
            <div style="display:flex;gap:8px;align-items:center;margin-bottom:14px">
              <div id="ls-offline-img-prev" style="width:70px;height:48px;border-radius:8px;border:1.5px solid var(--border);background:var(--g6);background-size:cover;background-position:center;display:flex;align-items:center;justify-content:center;font-size:1.4rem;flex-shrink:0">ğŸ“¡</div>
              <input type="hidden" id="ls-offline-img">
              <input type="file" id="ls-offline-file" accept="image/*" style="display:none" onchange="handleLsOfflinePhoto(event)">
              <button class="upload-btn-sm" onclick="document.getElementById('ls-offline-file').click()" style="padding:5px 12px">ğŸ“ Upload</button>
              <button class="upload-btn-sm" onclick="setLsOfflineUrl()" style="padding:5px 12px">ğŸ”— URL</button>
              <button class="upload-btn-sm" onclick="clearLsOfflineImg()" style="padding:5px 12px">âœ• Clear</button>
            </div>
          </div>
          <div style="border-top:1.5px solid var(--border);padding-top:16px;margin-top:4px">
            <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:8px">
              <label class="tm-lbl" style="margin:0">Past Streams (shown below the main embed)</label>
              <button class="upload-btn-sm" onclick="addPastStream()" style="padding:4px 10px">ï¼‹ Add</button>
            </div>
            <div id="ls-past-streams-list"></div>
          </div>
        </div>
        </div>
        <div id="home-editor-wrap" style="display:none">
          <div class="card">
            <label>Features Section Label (small text above heading)</label>
            <input type="text" id="feat-label" placeholder="e.g. Highlights, What We Offerâ€¦" style="margin-bottom:12px">
            <label>Features Section Heading</label>
            <input type="text" id="feat-heading" placeholder="e.g. What's here for you">
            <div style="display:flex;align-items:center;justify-content:space-between;margin-top:20px;margin-bottom:12px">
              <label style="margin:0">âœ¨ Feature Cards</label>
              <button class="upload-btn-sm" style="width:auto;padding:5px 12px" onclick="addFeatureCard()">ï¼‹ Add Card</button>
            </div>
            <p style="font-size:.77rem;color:var(--muted);margin-bottom:12px">Each card can have an emoji icon, image, title, description, and an optional link URL.</p>
            <div id="feature-cards-list"></div>
          </div>
          <div class="card">
            <label>ğŸ¬ Video Embed</label>
            <p style="font-size:.77rem;color:var(--muted);margin-bottom:12px">Paste a YouTube or Vimeo URL. It will show as a large featured video on your home page.</p>
            <div style="display:flex;flex-direction:column;gap:10px">
              <div>
                <label>Section Label (small text above heading)</label>
                <input type="text" id="video-label" placeholder="e.g. Watch, Featured">
              </div>
              <div>
                <label>Section Heading</label>
                <input type="text" id="video-heading" placeholder="e.g. Featured Video">
              </div>
              <div>
                <label>YouTube or Vimeo URL</label>
                <input type="url" id="video-url" placeholder="https://www.youtube.com/watch?v=â€¦">
              </div>
            </div>
          </div>
          <div class="card">
            <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:8px">
              <label style="margin:0">ğŸ“¸ Gallery Heading</label>
            </div>
            <input type="text" id="gallery-heading" placeholder="e.g. Photos, Our Workâ€¦" style="margin-bottom:14px">
            <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:12px">
              <label style="margin:0">ğŸ“¸ Photo Gallery</label>
              <button class="upload-btn-sm" style="width:auto;padding:5px 12px" onclick="addGalleryPhoto()">ï¼‹ Add Photo</button>
            </div>
            <p style="font-size:.77rem;color:var(--muted);margin-bottom:12px">Upload or link photos. Each has an optional caption. Unlimited photos supported.</p>
            <div id="gallery-list"></div>
          </div>
          <div class="card">
            <div style="display:flex;flex-direction:column;gap:12px;margin-bottom:14px">
              <div>
                <label>Posts Section Label</label>
                <input type="text" id="posts-label" placeholder="e.g. Updates, News, Blog">
              </div>
              <div>
                <label>Posts Section Heading</label>
                <input type="text" id="posts-heading" placeholder="e.g. Recent Posts">
              </div>
              <div>
                <label>Default Author Name</label>
                <input type="text" id="default-author" placeholder="e.g. Zavien">
              </div>
            </div>
            <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:6px">
              <label style="margin:0">ğŸ“ Posts / Updates</label>
              <button class="upload-btn-sm" style="width:auto;padding:5px 12px" onclick="addBlogPost()">ï¼‹ Add Post</button>
            </div>
            <div id="blog-posts-list"></div>
          </div>
        </div>
      </div>
      <div class="panel" id="panel-settings">
        <div class="panel-title">Site Settings</div>
        <div class="card">
          <div class="settings-row"><label>Site Name (shown in nav)</label><input type="text" id="site-name" placeholder="My Site"></div>
          <div class="settings-row"><label>Footer Text</label><input type="text" id="footer-text" placeholder="Â© 2025 My Website"></div>
          <div class="settings-row"><label>Browser Tab Title</label><input type="text" id="tab-title" placeholder="My Website"></div>
          <button class="save-settings-btn" onclick="saveAll()">Save Settings</button>
          <div class="confirm-msg" id="settings-confirm"></div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- MODALS -->
<div class="mini-modal" id="hgal-modal">
  <div class="mini-box">
    <h3>ğŸ“¸ Add Photo</h3>
    <div class="upload-area" onclick="document.getElementById('hgal-upload').click()">ğŸ“ Click to upload from device</div>
    <input type="file" id="hgal-upload" accept="image/*" style="display:none" onchange="handleHomeGalleryUpload(event)">
    <div class="or-row">or paste URL</div>
    <input type="url" id="hgal-url" placeholder="https://â€¦">
    <input type="text" id="hgal-caption" placeholder="Caption (optional)" style="margin-top:0">
    <div class="row">
      <button class="ok-btn" onclick="confirmHomeGalleryAdd()">Add Photo</button>
      <button class="no-btn" onclick="closeMM('hgal-modal')">Cancel</button>
    </div>
  </div>
</div>
<div class="mini-modal" id="post-editor-modal">
  <div class="mini-box" style="width:680px">
    <h3>âœï¸ Edit Post</h3>
    <div style="display:flex;gap:10px;margin-bottom:10px;flex-wrap:wrap">
      <input type="text" id="ped-title" placeholder="Post titleâ€¦" style="flex:2;min-width:160px">
      <input type="text" id="ped-author" placeholder="Author" style="flex:1;min-width:100px">
      <input type="text" id="ped-date" placeholder="Date" style="flex:1;min-width:120px">
    </div>
    <div class="toolbar">
      <button onclick="execPC('bold')"><b>B</b></button><button onclick="execPC('italic')"><i>I</i></button>
      <button onclick="execPC('underline')"><u>U</u></button>
      <div class="sep"></div>
      <button onclick="execPC('insertUnorderedList')">â€¢ List</button>
      <button onclick="execPC('insertOrderedList')">1. List</button>
      <div class="sep"></div>
      <button onclick="execPC('formatBlock','h3')">H3</button>
      <button onclick="execPC('formatBlock','p')">Â¶</button>
      <div class="sep"></div>
      <button onclick="execPC('undo')">â†©</button><button onclick="execPC('redo')">â†ª</button>
    </div>
    <div id="post-editor-body" contenteditable="true" spellcheck="true"></div>
    <div class="row" style="margin-top:12px">
      <button class="ok-btn" onclick="savePostEditor()">ğŸ’¾ Save Post</button>
      <button class="no-btn" onclick="closeMM('post-editor-modal')">Cancel</button>
    </div>
  </div>
</div>
<div class="mini-modal" id="new-page-modal">
  <div class="mini-box" style="width:560px">
    <h3>â• New Page</h3>
    <input type="text" id="new-page-name" placeholder="Page nameâ€¦" maxlength="40" style="margin-bottom:14px" onkeydown="if(event.key==='Enter')createPageFromModal()">
    <div style="font-size:.72rem;font-weight:700;text-transform:uppercase;letter-spacing:.08em;color:var(--muted);margin-bottom:10px">Choose a Template</div>
    <div id="template-grid" style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:16px;max-height:340px;overflow-y:auto;padding-right:4px"></div>
    <div class="row">
      <button class="ok-btn" onclick="createPageFromModal()">Create Page</button>
      <button class="no-btn" onclick="closeMM('new-page-modal')">Cancel</button>
    </div>
  </div>
</div>
<div class="mini-modal" id="rename-modal">
  <div class="mini-box" style="width:360px">
    <h3>âœï¸ Rename Page</h3>
    <input type="text" id="rename-input" placeholder="New nameâ€¦" maxlength="40" onkeydown="if(event.key==='Enter')doRenamePage()">
    <div class="row">
      <button class="ok-btn" onclick="doRenamePage()">Rename</button>
      <button class="no-btn" onclick="closeMM('rename-modal')">Cancel</button>
    </div>
  </div>
</div>
<div class="mini-modal" id="link-modal">
  <div class="mini-box" style="width:380px">
    <h3>ğŸ”— Insert Link</h3>
    <input type="text" id="link-text" placeholder="Link text (optional)">
    <input type="url" id="link-url" placeholder="https://â€¦">
    <div class="row">
      <button class="ok-btn" onclick="insertLink()">Insert</button>
      <button class="no-btn" onclick="closeMM('link-modal')">Cancel</button>
    </div>
  </div>
</div>
<div class="mini-modal" id="image-modal">
  <div class="mini-box">
    <h3>ğŸ–¼ Insert Image</h3>
    <div class="upload-area" onclick="document.getElementById('img-upload').click()">ğŸ“ Upload from device</div>
    <input type="file" id="img-upload" accept="image/*" style="display:none" onchange="handleImageUpload(event)">
    <div class="or-row">or paste URL</div>
    <input type="url" id="img-url" placeholder="https://â€¦">
    <input type="text" id="img-alt" placeholder="Alt text">
    <div class="row">
      <button class="ok-btn" onclick="insertImageFromUrl()">Insert</button>
      <button class="no-btn" onclick="closeMM('image-modal')">Cancel</button>
    </div>
  </div>
</div>
<div class="mini-modal" id="team-photo-modal">
  <div class="mini-box" style="width:360px">
    <h3>ğŸ“· Photo URL</h3>
    <input type="url" id="team-photo-url" placeholder="https://â€¦" onkeydown="if(event.key==='Enter')insertTeamPhotoUrl()">
    <div class="row">
      <button class="ok-btn" onclick="insertTeamPhotoUrl()">Insert</button>
      <button class="no-btn" onclick="closeMM('team-photo-modal')">Cancel</button>
    </div>
  </div>
</div>
<div class="mini-modal" id="res-photo-modal">
  <div class="mini-box" style="width:360px">
    <h3>ğŸ–¼ Image URL</h3>
    <input type="url" id="res-photo-url" placeholder="https://â€¦" onkeydown="if(event.key==='Enter')insertResPhotoUrl()">
    <div class="row">
      <button class="ok-btn" onclick="insertResPhotoUrl()">Insert</button>
      <button class="no-btn" onclick="closeMM('res-photo-modal')">Cancel</button>
    </div>
  </div>
</div>
<div id="save-toast">âœ“ Saved &amp; Published!</div>

<script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CONFIG
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const EJS_KEY  = 'JkggxodaGX8yuGKiq';
const EJS_SVC  = 'service_ucxl5yk';
const EJS_TPL  = 'template_wm4t0fo';
const ADMIN_EMAIL = 'zavien.786@gmail.com';
emailjs.init(EJS_KEY);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// STORAGE  â€” persistent (window.storage) for site data
//           â€” localStorage for admin sessions (survives reload)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const KEY_SITE = 'mysite_v6';

// Storage â€” localStorage primary (works as local HTML file), window.storage as bonus
function lsGet(k) { try { const v = localStorage.getItem(k); return v ? JSON.parse(v) : null; } catch { return null; } }
function lsSet(k, v) { try { localStorage.setItem(k, JSON.stringify(v)); return true; } catch(e) { return false; } }

async function pGet(k) {
  // Try localStorage first (works everywhere including local HTML files)
  const local = lsGet(k);
  if (local !== null) return local;
  // Fallback to window.storage if available (Claude.ai artifact environment)
  try { const r = await window.storage.get(k); return r ? JSON.parse(r.value) : null; } catch { return null; }
}
async function pSet(k, v) {
  // Always save to localStorage
  lsSet(k, v);
  // Also try window.storage if available
  try { await window.storage.set(k, JSON.stringify(v)); } catch(e) {}
}

const LS_SESSIONS = 'mysite_admin_sessions';

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// HELPERS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function uid()    { return Math.random().toString(36).slice(2, 9); }
function esc(s)   { return String(s).replace(/&/g,'&amp;').replace(/"/g,'&quot;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }
function slugify(n) { return n.toLowerCase().replace(/[^a-z0-9]+/g,'-').replace(/^-|-$/g,'') + '-' + Date.now().toString(36); }
function showToast(msg) {
  const t = document.getElementById('save-toast');
  t.textContent = msg; t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 3000);
}
function setMsg(id, msg, cls) {
  const el = document.getElementById(id);
  if (!el) return;
  el.textContent = msg; el.className = 'confirm-msg ' + cls;
  setTimeout(() => el.textContent = '', 3000);
}
function closeMM(id) { document.getElementById(id).classList.remove('show'); }
function openMM(id)  { document.getElementById(id).classList.add('show'); }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let site = null;
let currentPageId = null;
let savedRange = null;
let isAdminLoggedIn = false;

function defaultHomeBody() {
  return JSON.stringify({
    featLabel:   'Highlights',
    featHeading: "What's here for you",
    features: [
      {id:'f1', icon:'ğŸ¤–', img:'', link:'', title:'Card One', desc:'Edit this card from the admin panel â€” add a title, description, image, and link.'},
      {id:'f2', icon:'âš™ï¸', img:'', link:'', title:'Card Two', desc:'Click the admin button to customize every card with your own content.'},
      {id:'f3', icon:'ğŸ†', img:'', link:'', title:'Card Three', desc:'Add an image and a link to make this card interactive for visitors.'},
      {id:'f4', icon:'ğŸ”§', img:'', link:'', title:'Card Four', desc:'You can add, remove, and reorder cards anytime from the admin panel.'},
      {id:'f5', icon:'ğŸš€', img:'', link:'', title:'Card Five', desc:'Cards auto-rotate in a carousel when there are enough to fill the row.'},
    ],
    videoLabel: 'Watch', videoHeading: 'Featured Video', videoUrl: '',
    galleryHeading: 'Photos',
    gallery: [],
    postsLabel: 'Updates',
    postsHeading: 'Recent Posts',
    defaultAuthor: 'Admin',
    posts: []
  });
}

function defaultSite() {
  return {
    siteName: 'My Site',
    footer:   'Â© 2025 My Website',
    tabTitle: 'My Website',
    currentPage: 'home',
    pages: [{
      id: 'home', name: 'Home', isHome: true, pageType: 'home',
      heroTitle:    'Welcome to My Website',
      heroSubtitle: 'Your place on the web â€” log in as admin to edit everything.',
      body: defaultHomeBody()
    }]
  };
}

function getPage(id) { return site.pages.find(p => p.id === id); }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function init() {
  site = (await pGet(KEY_SITE)) || defaultSite();
  // Migrate: if home page has no pageType, give it one
  const home = site.pages.find(p => p.isHome);
  if (home && !home.pageType) {
    home.pageType = 'home';
    if (!home.body) home.body = defaultHomeBody();
  }
  // Migrate: if home body is missing new fields, merge
  if (home && home.pageType === 'home') {
    try {
      const d = JSON.parse(home.body || '{}');
      const def = JSON.parse(defaultHomeBody());
      const merged = Object.assign({}, def, d);
      // ensure features have img/link fields
      merged.features = (merged.features || []).map(f => Object.assign({img:'',link:'',icon:'â­',title:'',desc:''}, f));
      home.body = JSON.stringify(merged);
    } catch {}
  }
  renderPublicSite(site.currentPage || 'home');
  checkAdminSession();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ADMIN SESSION  (localStorage â€” survives reload)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Session: stores {expiry: timestamp} or null
// "Remember me" = 30 days, otherwise = session-only (0 expiry)
function setAdminSession(remember) {
  if (remember) {
    // Persist for 30 days in localStorage
    lsSet(LS_SESSIONS, {expiry: Date.now() + 30 * 24 * 60 * 60 * 1000, remember: true});
    sessionStorage.removeItem(LS_SESSIONS);
  } else {
    // Session-only: use sessionStorage so it clears when browser closes
    sessionStorage.setItem(LS_SESSIONS, JSON.stringify({expiry: 0, remember: false}));
    localStorage.removeItem(LS_SESSIONS);
  }
}
function clearAdminSession() {
  localStorage.removeItem(LS_SESSIONS);
  sessionStorage.removeItem(LS_SESSIONS);
}
function checkAdminSession() {
  // Check localStorage first (30-day), then sessionStorage (session-only)
  let s = lsGet(LS_SESSIONS);
  if (!s) {
    try { const raw = sessionStorage.getItem(LS_SESSIONS); s = raw ? JSON.parse(raw) : null; } catch {}
  }
  if (!s) { hideAdminBtn(); return; }
  if (s.expiry !== 0 && s.expiry < Date.now()) {
    clearAdminSession(); hideAdminBtn(); return;
  }
  isAdminLoggedIn = true;
  showAdminBtn();
}

function logoutAdmin() {
  clearAdminSession();
  isAdminLoggedIn = false;
  hideAdminBtn();
  logout();
}
function showAdminBtn() {
  document.getElementById('admin-mode-btn').style.display = 'flex';
  document.getElementById('admin-link').style.display = 'none';
}
function hideAdminBtn() {
  document.getElementById('admin-mode-btn').style.display = 'none';
  document.getElementById('admin-link').style.display = 'block';
}

function switchToAdminMode() { enterAdmin(); }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// EMAIL LOGIN
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let currentCode = null, codeExpiry = null;

function showLogin() {
  openMM('login-overlay'); backToSend();
}
function hideLogin() { closeMM('login-overlay'); }
function backToSend() {
  document.getElementById('step-send').classList.remove('hidden');
  document.getElementById('step-verify').classList.add('hidden');
  document.getElementById('send-err').textContent = '';
  const b = document.getElementById('send-btn');
  b.disabled = false; b.innerHTML = 'Send Verification Code';
}

async function sendCode() {
  const btn = document.getElementById('send-btn');
  btn.disabled = true;
  btn.innerHTML = '<span class="spinner"></span> Sendingâ€¦';
  document.getElementById('send-err').textContent = '';
  currentCode = String(Math.floor(100000 + Math.random() * 900000));
  codeExpiry = Date.now() + 10 * 60 * 1000;
  try {
    await emailjs.send(EJS_SVC, EJS_TPL, { code: currentCode, to_email: ADMIN_EMAIL });
    document.getElementById('step-send').classList.add('hidden');
    document.getElementById('step-verify').classList.remove('hidden');
    document.getElementById('code-input').value = '';
    document.getElementById('verify-err').textContent = '';
    setTimeout(() => document.getElementById('code-input').focus(), 60);
  } catch (err) {
    document.getElementById('send-err').textContent = 'Failed to send. Check EmailJS config.';
    btn.disabled = false; btn.innerHTML = 'Send Verification Code';
  }
}

function resendCode() { backToSend(); setTimeout(sendCode, 100); }

function verifyCode() {
  const entered = document.getElementById('code-input').value.trim();
  const errEl   = document.getElementById('verify-err');
  if (!currentCode)            { errEl.textContent = 'No code sent. Request a new one.'; return; }
  if (Date.now() > codeExpiry) { errEl.textContent = 'Code expired. Request a new one.'; backToSend(); return; }
  if (entered !== currentCode) { errEl.textContent = 'Incorrect code. Try again.'; document.getElementById('code-input').select(); return; }

  // Success
  const rememberMe = document.getElementById('remember-me-chk').checked;
  setAdminSession(rememberMe);

  currentCode = null;
  isAdminLoggedIn = true;
  hideLogin();
  showAdminBtn();
  enterAdmin();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PUBLIC RENDERING
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderPublicSite(pageId) {
  const page = getPage(pageId) || site.pages[0];
  site.currentPage = page.id;

  // Nav
  const navEl = document.getElementById('pub-nav-links');
  navEl.innerHTML = '';
  site.pages.forEach(p => {
    const a = document.createElement('a');
    a.textContent = p.name;
    a.className = p.id === page.id ? 'active' : '';
    a.onclick = () => navigateTo(p.id);
    navEl.appendChild(a);
  });

  // Logo
  const parts = (site.siteName || 'My Site').trim().split(/\s+/);
  document.getElementById('pub-logo-text').innerHTML =
    parts.length > 1 ? parts[0] + ' <span>' + parts.slice(1).join(' ') + '</span>' : '<span>' + esc(site.siteName) + '</span>';

  // Hero
  document.getElementById('pub-title').textContent    = page.heroTitle    || page.name;
  document.getElementById('pub-subtitle').textContent = page.heroSubtitle || '';
  document.getElementById('pub-hero').className = page.isHome ? 'pub-hero' : 'pub-hero compact';

  // Content
  const pt      = page.pageType || (page.isHome ? 'home' : 'rich');
  const generic = document.getElementById('pub-generic-content');
  const homeEl  = document.getElementById('pub-home-content');
  const bodyEl  = document.getElementById('pub-body-content');

  if (pt === 'home') {
    generic.style.display = 'none';
    homeEl.style.display  = 'block';
    renderHomePublic(page);
  } else {
    generic.style.display = 'block';
    homeEl.style.display  = 'none';
    if      (pt === 'rich')      bodyEl.innerHTML = page.body || '';
    else if (pt === 'team')      bodyEl.innerHTML = renderTeamPublic(page.body);
    else if (pt === 'resources') bodyEl.innerHTML = renderResourcesPublic(page.body);
    else if (pt === 'canvas')    bodyEl.innerHTML = '<div style="padding:40px;text-align:center;color:var(--muted)"><em>Canvas page</em></div>';
    else if (pt === 'events')        bodyEl.innerHTML = renderEventsPublic(page.body);
    else if (pt === 'buildblog')    bodyEl.innerHTML = renderBuildBlogPublic(page.body);
    else if (pt === 'matchvideos')  bodyEl.innerHTML = renderMatchVideosPublic(page.body);
    else if (pt === 'compschedule') bodyEl.innerHTML = renderCompSchedulePublic(page.body);
    else if (pt === 'robotshowcase') bodyEl.innerHTML = renderRobotShowcasePublic(page.body);
    else if (pt === 'livestream')    bodyEl.innerHTML = renderLivestreamPublic(page.body);
  }

  document.getElementById('pub-footer-text').textContent = site.footer || 'Â© 2025 My Website';
  document.title = site.tabTitle || 'My Website';
}

function navigateTo(pageId) {
  renderPublicSite(pageId);
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ADMIN
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function enterAdmin() {
  document.getElementById('public-view').style.display  = 'none';
  document.getElementById('admin-link').style.display   = 'none';
  document.getElementById('admin-view').style.display   = 'block';
  document.getElementById('site-name').value   = site.siteName || '';
  document.getElementById('footer-text').value = site.footer   || '';
  document.getElementById('tab-title').value   = site.tabTitle || '';
  renderSidebarPages();
  openPageEditor(site.pages[0].id);
}

function logout() {
  document.getElementById('admin-view').style.display  = 'none';
  document.getElementById('public-view').style.display = 'block';
  // Re-check session to show/hide admin button appropriately
  if (isAdminLoggedIn) showAdminBtn();
  else hideAdminBtn();
}

function enterPreview() {
  saveCurrentPage();
  site.siteName = document.getElementById('site-name').value  || 'My Site';
  site.footer   = document.getElementById('footer-text').value || 'Â© 2025 My Website';
  site.tabTitle = document.getElementById('tab-title').value  || 'My Website';
  renderPublicSite(currentPageId || 'home');
  document.getElementById('admin-view').style.display    = 'none';
  document.getElementById('public-view').style.display   = 'block';
  document.getElementById('admin-link').style.display    = 'none';
  document.getElementById('preview-banner').style.display = 'flex';
  // Keep admin button visible during preview so they can switch back
  document.getElementById('admin-mode-btn').style.display = 'none';
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

function exitPreview() {
  document.getElementById('preview-banner').style.display = 'none';
  document.getElementById('public-view').style.display    = 'none';
  document.getElementById('admin-view').style.display     = 'block';
  if (isAdminLoggedIn) showAdminBtn();
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

// â”€â”€â”€ Sidebar â”€â”€â”€
function renderSidebarPages() {
  const list = document.getElementById('page-list');
  list.innerHTML = '';
  site.pages.forEach(p => {
    const btn = document.createElement('button');
    btn.className = 'page-list-item' + (p.id === currentPageId ? ' active' : '');
    btn.innerHTML = '<span class="page-name">' + esc(p.name) + '</span>'
      + (p.isHome ? '<span class="home-badge">Home</span>' : '')
      + (!p.isHome ? '<button class="del-btn" onclick="event.stopPropagation();confirmDeletePage(\'' + p.id + '\')">âœ•</button>' : '');
    btn.onclick = () => openPageEditor(p.id);
    list.appendChild(btn);
  });
}

function switchToSettings() {
  saveCurrentPage(); currentPageId = null;
  document.querySelectorAll('.page-list-item').forEach(b => b.classList.remove('active'));
  document.querySelectorAll('.sidebar-btn').forEach(b => b.classList.remove('active'));
  document.querySelector('[data-panel="settings"]').classList.add('active');
  document.getElementById('panel-page').classList.remove('active');
  document.getElementById('panel-settings').classList.add('active');
}

// â”€â”€â”€ Page editor â”€â”€â”€
function openPageEditor(pageId) {
  saveCurrentPage();
  currentPageId = pageId;
  const page = getPage(pageId); if (!page) return;
  renderSidebarPages();
  document.getElementById('panel-settings').classList.remove('active');
  document.getElementById('panel-page').classList.add('active');
  document.querySelectorAll('.sidebar-btn').forEach(b => b.classList.remove('active'));
  document.getElementById('editing-page-name').textContent = page.name;
  document.getElementById('hero-title').value    = page.heroTitle    || '';
  document.getElementById('hero-subtitle').value = page.heroSubtitle || '';
  const pt = page.pageType || (page.isHome ? 'home' : 'rich');
  ['rich','canvas','team','resources','home','events','buildblog','matchvideos','compschedule','robotshowcase','livestream'].forEach(t =>
    document.getElementById(t + '-editor-wrap').style.display = pt === t ? 'block' : 'none'
  );
  if (pt === 'rich')          document.getElementById('editor').innerHTML = page.body || '';
  else if (pt === 'team')     initTeamEditor(page);
  else if (pt === 'resources') initResEditor(page);
  else if (pt === 'home')     initHomeEditor(page);
  else if (pt === 'canvas')   initCanvas(page);
  else if (pt === 'events')       initEventsEditor(page);
  else if (pt === 'buildblog')    initBuildBlog(page);
  else if (pt === 'matchvideos')  initMatchVideos(page);
  else if (pt === 'compschedule') initCompSchedule(page);
  else if (pt === 'robotshowcase') initRobotShowcase(page);
  else if (pt === 'livestream')    initLivestream(page);
  document.getElementById('delete-page-btn').style.display = page.isHome ? 'none' : 'flex';
}

function saveCurrentPage() {
  if (!currentPageId) return;
  const page = getPage(currentPageId); if (!page) return;
  page.heroTitle    = document.getElementById('hero-title').value;
  page.heroSubtitle = document.getElementById('hero-subtitle').value;
  const pt = page.pageType || (page.isHome ? 'home' : 'rich');
  if      (pt === 'rich')      page.body = document.getElementById('editor').innerHTML;
  else if (pt === 'team')      page.body = saveTeam();
  else if (pt === 'resources') page.body = saveRes();
  else if (pt === 'home')      page.body = saveHome();
  else if (pt === 'canvas')    page.body = saveCanvas();
  else if (pt === 'events')        page.body = saveEvents();
  else if (pt === 'buildblog')    page.body = saveBuildBlog();
  else if (pt === 'matchvideos')  page.body = saveMatchVideos();
  else if (pt === 'compschedule') page.body = saveCompSchedule();
  else if (pt === 'robotshowcase') page.body = saveRobotShowcase();
  else if (pt === 'livestream')    page.body = saveLivestream();
}

async function saveAll() {
  saveCurrentPage();
  site.siteName = document.getElementById('site-name').value  || 'My Site';
  site.footer   = document.getElementById('footer-text').value || 'Â© 2025 My Website';
  site.tabTitle = document.getElementById('tab-title').value  || 'My Website';
  await pSet(KEY_SITE, site);
  renderPublicSite(site.currentPage || 'home');
  showToast('âœ“ Saved & Published!');
  setMsg('settings-confirm', 'Saved!', 'ok');
}

// â”€â”€â”€ Page management â”€â”€â”€
let selTpl = 'blank';
const TEMPLATES = [
  {id:'blank',icon:'ğŸ“„',name:'Blank',desc:'Start from scratch',pageType:'rich',heroTitle:'',heroSubtitle:'',body:''},
  {id:'about',icon:'ğŸ‘¤',name:'About Me',desc:'Bio & highlights',pageType:'rich',heroTitle:'About Me',heroSubtitle:'A little about who I am',body:'<h2>Hey there!</h2><p>Welcome! I\'m passionate about [topic].</p><hr><h3>ğŸŒ± Background</h3><p>Fill in your story here.</p><h3>ğŸ’¼ What I Do</h3><p>Describe your work.</p>'},
  {id:'contact',icon:'ğŸ“¬',name:'Contact',desc:'Email & socials',pageType:'rich',heroTitle:'Get in Touch',heroSubtitle:"I'd love to hear from you",body:'<h2>Let\'s Connect</h2><h3>ğŸ“§ Email</h3><p><a href="mailto:your@email.com">your@email.com</a></p><h3>ğŸ”— Socials</h3><ul><li><a href="#">Instagram</a></li><li><a href="#">Twitter</a></li></ul>'},
  {id:'blog',icon:'âœï¸',name:'Blog Post',desc:'Article layout',pageType:'rich',heroTitle:'Post Title',heroSubtitle:'Date here',body:'<p><em>Introâ€¦</em></p><hr><h2>Main Point</h2><p>Write here.</p>'},
  {id:'services',icon:'ğŸ’¼',name:'Services',desc:'Offerings & pricing',pageType:'rich',heroTitle:'What I Offer',heroSubtitle:'Services tailored to your needs',body:'<h2>How I Can Help</h2><hr><h3>â­ Service One â€” $XX</h3><p>Describe this service.</p>'},
  {id:'faq',icon:'â“',name:'FAQ',desc:'Q&A page',pageType:'rich',heroTitle:'FAQ',heroSubtitle:'Everything you need to know',body:'<h2>Got Questions?</h2><hr><h3>Q: First question?</h3><p>A: Your answer here.</p>'},
  {id:'comingsoon',icon:'ğŸš€',name:'Coming Soon',desc:'Teaser page',pageType:'rich',heroTitle:'Something Big Is Coming',heroSubtitle:"Stay tuned!",body:'<h2>ğŸš§ Under Construction</h2><p>Check back soon!</p>'},
  {id:'team',icon:'ğŸ‘¥',name:'About Us',desc:'Team grid with photos',pageType:'team',heroTitle:'Meet the Team',heroSubtitle:'The people behind the work',body:JSON.stringify([{id:'t1',name:'Team Member One',role:'Founder',bio:'Short bio here.',img:'',links:[]},{id:'t2',name:'Team Member Two',role:'Designer',bio:'Short bio here.',img:'',links:[]}])},
  {id:'resources',icon:'ğŸ“š',name:'Resources',desc:'Links with images',pageType:'resources',heroTitle:'Resources',heroSubtitle:'Useful links and tools',body:JSON.stringify([{id:'r1',category:'Getting Started',title:'Example Resource',description:'A helpful link.',url:'https://example.com',img:''}])},
  {id:'events',icon:'ğŸ‰',name:'Events',desc:'Events with photos & links',pageType:'events',heroTitle:'Events',heroSubtitle:'What we have coming up',body:JSON.stringify([{id:'e1',date:'March 15, 2026',title:'Example Event',desc:'A short description of this event.',location:'City, State',img:'',link:'',linkLabel:'Get Tickets'}])},
  {id:'buildblog',icon:'ğŸ”§',name:'Build Blog',desc:'Season build updates with photos',pageType:'buildblog',heroTitle:'Build Season',heroSubtitle:'Follow our progress week by week',body:JSON.stringify([{id:'bb1',week:'Week 1',date:'',title:'Kickoff Day',body:'<p>We received the game manual and started brainstorming robot designs.</p>',imgs:[],tags:'kickoff'}])},
  {id:'matchvideos',icon:'ğŸ¥',name:'Match Videos',desc:'Embedded match video gallery',pageType:'matchvideos',heroTitle:'Match Videos',heroSubtitle:'Watch our robots compete',body:JSON.stringify([{id:'mv1',event:'Regional Championship',match:'Qualification 1',url:'',thumbnail:'',notes:''}])},
  {id:'compschedule',icon:'ğŸ“†',name:'Competition Schedule',desc:'Upcoming events & results',pageType:'compschedule',heroTitle:'Competition Schedule',heroSubtitle:'Where we are competing this season',body:JSON.stringify({season:'2025-2026',events:[{id:'cs1',name:'Example Regional',date:'March 8-10, 2026',location:'City Convention Center',status:'upcoming',rank:'',record:'',link:'',img:''}]})},
  {id:'robotshowcase',icon:'ğŸ¤–',name:'Robot Showcase',desc:'Robot specs, photos & features',pageType:'robotshowcase',heroTitle:'Meet the Robot',heroSubtitle:'Built by our team this season',body:JSON.stringify({robotName:'Robot Name',year:'2026',tagline:'',mainImg:'',specs:[{id:'s1',label:'Weight',value:''},{id:'s2',label:'Drivetrain',value:''},{id:'s3',label:'Height',value:''},{id:'s4',label:'Autonomous',value:''}],features:[{id:'ft1',title:'Feature 1',desc:'',img:''}],gallery:[]})},,
  {id:'livestream',icon:'ğŸ“¡',name:'Livestream',desc:'Live & upcoming stream embeds',pageType:'livestream',heroTitle:'Watch Live',heroSubtitle:'Tune in when we compete',body:JSON.stringify({status:'offline',streamUrl:'',scheduledTime:'',scheduledDesc:'',offlineMsg:'No stream currently live. Check back during competitions!',offlineImg:'',chatUrl:'',pastStreams:[]})}
];

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PAGE MANAGEMENT UI
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openNewPageModal() {
  selTpl = 'blank';
  renderTemplatePicker();
  document.getElementById('new-page-name').value = '';
  openMM('new-page-modal');
}
function selectTpl(id) {
  selTpl = id;
  document.querySelectorAll('.tpl-card').forEach(c => c.classList.toggle('selected', c.dataset.tpl === id));
  const tpl = TEMPLATES.find(t => t.id === id);
  if (tpl && !document.getElementById('new-page-name').value.trim()) {
    document.getElementById('new-page-name').value = tpl.name;
  }
}
function createPageFromModal() {
  const name = document.getElementById('new-page-name').value.trim() || 'New Page';
  const tpl  = TEMPLATES.find(t => t.id === selTpl) || TEMPLATES[0];
  const page = {
    id: uid(), name, pageType: tpl.pageType || 'rich',
    heroTitle: tpl.heroTitle || name, heroSubtitle: tpl.heroSubtitle || '',
    body: tpl.body || ''
  };
  site.pages.push(page);
  closeMM('new-page-modal');
  openPageEditor(page.id);
  renderSidebarPages();
}
function deleteCurrentPage() { if (currentPageId) deletePage(currentPageId); }
function deletePage(id) {
  if (site.pages.length <= 1) { alert('You must have at least one page.'); return; }
  if (!confirm('Delete this page?')) return;
  site.pages = site.pages.filter(p => p.id !== id);
  currentPageId = null;
  openPageEditor(site.pages[0].id);
}
function renamePage(id) {
  const page = getPage(id); if (!page) return;
  const n = prompt('Page name:', page.name); if (!n) return;
  page.name = n.trim();
  document.getElementById('editing-page-name').textContent = page.name;
  renderSidebarPages();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// RICH TEXT EDITOR TOOLBAR
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function fmt(cmd, val) {
  document.getElementById('editor').focus();
  document.execCommand(cmd, false, val || null);
}
function fmtLink() {
  const url = prompt('URL:', 'https://');
  if (url) fmt('createLink', url);
}
function fmtImg() {
  const url = prompt('Image URL:');
  if (url) fmt('insertImage', url);
}
function fmtFontSize(v) { fmt('fontSize', v); }
function fmtForeColor(v) { fmt('foreColor', v); }
function insertEditorImg(file) {
  const r = new FileReader();
  r.onload = e => { fmt('insertImage', e.target.result); };
  r.readAsDataURL(file);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// VIDEO EMBED HELPER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function videoEmbedUrl(url) {
  if (!url) return '';
  let m = url.match(/(?:youtube\.com\/watch\?v=|youtu\.be\/)([^&\s]+)/);
  if (m) return 'https://www.youtube.com/embed/' + m[1] + '?rel=0&modestbranding=1';
  m = url.match(/youtube\.com\/live\/([^?&\s]+)/);
  if (m) return 'https://www.youtube.com/embed/' + m[1] + '?rel=0&modestbranding=1';
  m = url.match(/vimeo\.com\/(\d+)/);
  if (m) return 'https://player.vimeo.com/video/' + m[1];
  // Twitch
  m = url.match(/twitch\.tv\/([^/?&\s]+)/);
  if (m) {
    const parent = window.location.hostname || 'localhost';
    return 'https://player.twitch.tv/?channel=' + m[1] + '&parent=' + parent;
  }
  return '';
}

function youtubeLiveChat(url, videoId) {
  // Build live chat embed URL
  const parent = window.location.hostname || 'localhost';
  if (url) return url; // user-supplied custom chat URL
  if (videoId) return 'https://www.youtube.com/live_chat?v=' + videoId + '&embed_domain=' + parent;
  return '';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PUBLIC RENDERERS â€” TEAM
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderTeamPublic(body) {
  let members; try { members = JSON.parse(body || '[]'); } catch { members = []; }
  if (!members.length) return '<p style="color:var(--muted);text-align:center;padding:40px"><em>No team members yet.</em></p>';
  return '<div class="pub-team-grid">' + members.map(m =>
    '<div class="pub-team-card">'
    + (m.img ? '<div class="pub-team-img" style="background-image:url(\'' + esc(m.img) + '\')"></div>'
             : '<div class="pub-team-img pub-team-img-placeholder">ğŸ‘¤</div>')
    + '<div class="pub-team-info">'
      + '<div class="pub-team-name">' + esc(m.name || '') + '</div>'
      + '<div class="pub-team-role">' + esc(m.role || '') + '</div>'
      + (m.bio ? '<div class="pub-team-bio">' + esc(m.bio) + '</div>' : '')
      + (m.links && m.links.length ? '<div class="pub-team-links">' + m.links.map(l =>
          '<a href="' + esc(l.url) + '" target="_blank" rel="noopener" class="pub-team-link">' + esc(l.label) + '</a>').join('') + '</div>' : '')
    + '</div>'
    + '</div>'
  ).join('') + '</div>';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PUBLIC RENDERERS â€” RESOURCES
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderResourcesPublic(body) {
  let items; try { items = JSON.parse(body || '[]'); } catch { items = []; }
  if (!items.length) return '<p style="color:var(--muted);text-align:center;padding:40px"><em>No resources yet.</em></p>';
  const groups = {};
  items.forEach(i => { const cat = i.category || 'General'; if (!groups[cat]) groups[cat] = []; groups[cat].push(i); });
  return Object.entries(groups).map(([cat, its]) =>
    '<h2 style="font-family:\'Playfair Display\',serif;color:var(--g1);margin:28px 0 14px">' + esc(cat) + '</h2>'
    + '<div class="pub-resources-grid">' + its.map(i =>
      '<a class="pub-resource-card" href="' + esc(i.url || '#') + '" target="_blank" rel="noopener">'
      + (i.img ? '<div class="pub-resource-img" style="background-image:url(\'' + esc(i.img) + '\')"></div>'
               : '<div class="pub-resource-img pub-resource-img-ph">ğŸ”—</div>')
      + '<div class="pub-resource-body">'
        + '<div class="pub-resource-title">' + esc(i.title || '') + '</div>'
        + (i.description ? '<div class="pub-resource-desc">' + esc(i.description) + '</div>' : '')
      + '</div>'
      + '</a>'
    ).join('') + '</div>'
  ).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PUBLIC RENDERERS â€” EVENTS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderEventsPublic(body) {
  let events; try { events = JSON.parse(body || '[]'); } catch { events = []; }
  if (!events.length) return '<p style="color:var(--muted);text-align:center;padding:40px"><em>No events yet.</em></p>';
  return '<div class="pub-events-grid">' + events.map(e =>
    '<div class="pub-event-card">'
    + (e.img ? '<div class="pub-event-img" style="background-image:url(\'' + esc(e.img) + '\')"></div>'
             : '<div class="pub-event-img pub-event-img-ph">ğŸ‰</div>')
    + '<div class="pub-event-body">'
      + (e.date ? '<div class="pub-event-date">' + esc(e.date) + '</div>' : '')
      + '<div class="pub-event-title">' + esc(e.title || '') + '</div>'
      + (e.location ? '<div class="pub-event-location">ğŸ“ ' + esc(e.location) + '</div>' : '')
      + (e.desc ? '<div class="pub-event-desc">' + esc(e.desc) + '</div>' : '')
      + (e.link ? '<a class="pub-event-btn" href="' + esc(e.link) + '" target="_blank" rel="noopener">' + esc(e.linkLabel || 'Learn More') + '</a>' : '')
    + '</div>'
    + '</div>'
  ).join('') + '</div>';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PUBLIC RENDERERS â€” HOME
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let carouselIdx = 0, carouselTotal = 0, carouselVisible = 3;
let carouselCardW = 260, carouselGap = 16, carouselTimer = null;

function renderHomePublic(page) {
  let d; try { d = JSON.parse(page.body || '{}'); } catch { d = {}; }
  const features = d.features || [];
  const gallery  = d.gallery  || [];
  const posts    = d.posts    || [];
  const videoUrl = d.videoUrl || '';

  // Posts
  const postsEl = document.getElementById('pub-posts');
  if (posts.length) {
    postsEl.style.display = 'block';
    postsEl.innerHTML =
      '<div class="home-section-wrap">'
      + '<div class="home-section-label">' + esc(d.postsLabel || 'Updates') + '</div>'
      + '<h2 class="home-section-heading">' + esc(d.postsHeading || 'Recent Posts') + '</h2>'
      + '<div class="home-posts-grid">' + posts.map(p =>
          '<div class="home-post-card">'
          + '<div class="home-post-header"><div class="home-post-meta">' + esc(p.date || '') + (p.author ? ' Â· ' + esc(p.author) : '') + '</div></div>'
          + '<div class="home-post-title">' + esc(p.title || '') + '</div>'
          + '<div class="home-post-body">' + (p.body || '') + '</div>'
          + '</div>'
        ).join('')
      + '</div></div>';
  } else { postsEl.style.display = 'none'; }

  // Features
  const featEl = document.getElementById('pub-features');
  if (features.length) {
    featEl.style.display = 'block';
    const cardW = 260;
    const cardHTML = features.map((f, cardIdx) => {
      const cardInner =
        '<div class="hfc-img" style="' + (f.img ? 'background-image:url(\'' + esc(f.img) + '\')' : 'background:var(--g5);display:flex;align-items:center;justify-content:center;') + '">'
        + (!f.img ? '<span class="hfc-icon-wrap">' + f.icon + '</span>' : '') + '</div>'
        + '<div style="display:flex;flex-direction:column;gap:8px;padding:4px 0;flex:1">'
          + '<div class="hfc-icon-wrap">' + f.icon + '</div>'
          + '<div class="hfc-title">' + esc(f.title || '') + '</div>'
          + (f.desc ? '<div class="hfc-desc">' + esc(f.desc) + '</div>' : '')
        + '</div>';
      const tag   = f.link ? 'a' : 'div';
      const attrs = f.link ? ' href="' + esc(f.link) + '" target="_blank" rel="noopener"' : '';
      return '<' + tag + ' class="home-feature-card" style="width:' + cardW + 'px" data-cidx="' + cardIdx + '"' + attrs + '>' + cardInner + '</' + tag + '>';
    }).join('');

    const label   = esc(d.featLabel   || 'Highlights');
    const heading = esc(d.featHeading || "What's here for you");

    if (features.length <= 4) {
      featEl.innerHTML = '<div class="home-section-wrap"><div class="home-section-label">' + label + '</div><h2 class="home-section-heading">' + heading + '</h2><div class="feat-centered">' + cardHTML + '</div></div>';
    } else {
      featEl.innerHTML =
        '<div class="home-section-wrap">'
        + '<div class="home-section-label">' + label + '</div>'
        + '<h2 class="home-section-heading">' + heading + '</h2>'
        + '<div class="feat-carousel-outer" id="feat-carousel-outer">'
          + '<button class="feat-arrow feat-arrow-left" onclick="carouselStep(-1)">&#8592;</button>'
          + '<div class="feat-carousel-clip">'
            + '<div class="feat-carousel-track" id="feat-carousel-track">' + cardHTML + '</div>'
          + '</div>'
          + '<button class="feat-arrow feat-arrow-right" onclick="carouselStep(1)">&#8594;</button>'
        + '</div>'
        + '<div class="feat-dots" id="feat-dots"></div>'
        + '</div>';
      setTimeout(() => initCarousel(features.length, cardW), 30);
    }
  } else { featEl.style.display = 'none'; }

  // Video
  const vidEl = document.getElementById('pub-video');
  if (videoUrl) {
    vidEl.style.display = 'block';
    const embed = videoEmbedUrl(videoUrl);
    vidEl.innerHTML = embed
      ? '<div class="home-section-wrap"><div class="home-video-wrap"><iframe src="' + embed + '" frameborder="0" allowfullscreen allow="accelerometer;autoplay;clipboard-write;encrypted-media;gyroscope;picture-in-picture"></iframe></div></div>'
      : '<div class="home-section-wrap"><p style="color:var(--muted)">Invalid video URL</p></div>';
  } else { vidEl.style.display = 'none'; }

  // Gallery
  const galEl = document.getElementById('pub-gallery');
  if (gallery.length) {
    galEl.style.display = 'block';
    galEl.innerHTML =
      '<div class="home-section-wrap">'
      + '<div class="home-section-label">' + esc(d.galleryHeading || 'Photos') + '</div>'
      + '<div class="pub-gallery-grid">' + gallery.map(g =>
          '<div class="pub-gallery-item" style="background-image:url(\'' + esc(g.url || g) + '\')" onclick="openLightbox(\'' + esc(g.url || g) + '\')">'
          + (g.caption ? '<div class="pub-gallery-caption">' + esc(g.caption) + '</div>' : '')
          + '</div>'
        ).join('') + '</div></div>';
  } else { galEl.style.display = 'none'; }
}

function openLightbox(src) {
  let lb = document.getElementById('lightbox');
  if (!lb) {
    lb = document.createElement('div');
    lb.id = 'lightbox';
    lb.style.cssText = 'position:fixed;inset:0;background:rgba(0,0,0,.88);z-index:9999;display:flex;align-items:center;justify-content:center;cursor:zoom-out;';
    lb.onclick = () => lb.remove();
    const img = document.createElement('img');
    img.style.cssText = 'max-width:92vw;max-height:92vh;border-radius:10px;box-shadow:0 8px 40px rgba(0,0,0,.6);';
    lb.appendChild(img);
    document.body.appendChild(lb);
  }
  lb.querySelector('img').src = src;
  lb.style.display = 'flex';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// FEATURE CARD CAROUSEL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function initCarousel(totalCards, cardW) {
  const track = document.getElementById('feat-carousel-track');
  if (!track) return;
  Array.from(track.querySelectorAll('[aria-hidden]')).forEach(n => n.remove());
  Array.from(track.children).forEach(c => c.classList.remove('carousel-center'));

  carouselTotal = totalCards;
  carouselGap = 16;
  const outer = document.getElementById('feat-carousel-outer');
  if (!outer) return;
  const clipEl = outer.querySelector('.feat-carousel-clip') || outer;
  const outerW = clipEl.clientWidth;

  // Show 3 full cards + ~half peeking each side
  carouselCardW = Math.max(180, Math.floor((outerW - carouselGap * 4) / 3.76));
  carouselVisible = 3;

  Array.from(track.children).forEach(c => { c.style.width = carouselCardW + 'px'; });

  const realCards  = Array.from(track.children);
  const cloneCount = Math.min(3, carouselTotal);
  for (let i = realCards.length - cloneCount; i < realCards.length; i++) {
    const clone = realCards[i].cloneNode(true);
    clone.setAttribute('aria-hidden', 'true');
    clone.style.width = carouselCardW + 'px';
    track.insertBefore(clone, track.firstChild);
  }
  for (let i = 0; i < cloneCount; i++) {
    const clone = realCards[i].cloneNode(true);
    clone.setAttribute('aria-hidden', 'true');
    clone.style.width = carouselCardW + 'px';
    track.appendChild(clone);
  }

  carouselIdx = cloneCount;
  carouselGo(carouselIdx, true);
  renderCenter();
  renderDots();
  startCarouselAuto();
}

function renderCenter() {
  const track = document.getElementById('feat-carousel-track');
  if (!track) return;
  const cards = Array.from(track.children);
  const centerIdx = carouselIdx + 1;
  const cloneCount = Math.min(3, carouselTotal);

  cards.forEach((c, i) => {
    const isCenter = i === centerIdx;
    c.classList.toggle('carousel-center', isCenter);

    // Click on non-center card â†’ jump to it
    c.onclick = (e) => {
      if (isCenter) return; // center card: let link/normal click through
      e.preventDefault();
      // Figure out which real card index this is
      const cidx = c.getAttribute('data-cidx');
      if (cidx !== null) {
        // Jump directly to this card as center
        carouselIdx = parseInt(cidx) + cloneCount - 1;
        carouselGo(carouselIdx, false);
        renderCenter();
        renderDots();
        resetCarouselAuto();
      } else {
        // Cloned card without data-cidx: step toward it
        const dir = i < centerIdx ? -1 : 1;
        carouselStep(dir);
      }
    };

    // Cursor: pointer for non-center, default for center (unless it's a link)
    if (!isCenter) {
      c.style.cursor = 'pointer';
    } else {
      c.style.cursor = c.tagName === 'A' ? 'pointer' : 'default';
    }
  });
}

function carouselStep(dir) {
  if (carouselTotal === 0) return;
  const track = document.getElementById('feat-carousel-track');
  if (!track) return;
  const cloneCount = Math.min(3, carouselTotal);
  const firstReal  = cloneCount;
  const lastReal   = cloneCount + carouselTotal - 1;

  carouselIdx += dir;
  carouselGo(carouselIdx, false);
  renderCenter();
  renderDots();
  resetCarouselAuto();

  setTimeout(() => {
    if (carouselIdx > lastReal) {
      carouselIdx = firstReal + (carouselIdx - lastReal - 1);
      carouselGo(carouselIdx, true);
    } else if (carouselIdx < firstReal) {
      carouselIdx = lastReal - (firstReal - carouselIdx - 1);
      carouselGo(carouselIdx, true);
    }
    renderCenter();
    renderDots();
  }, 510);
}

function carouselGo(idx, instant) {
  const track = document.getElementById('feat-carousel-track');
  if (!track) return;
  if (instant) track.classList.add('no-transition');
  const halfPeek = Math.round(carouselCardW * 0.38 + carouselGap);
  const offset   = idx * (carouselCardW + carouselGap) - halfPeek;
  track.style.transform = 'translateX(-' + offset + 'px)';
  if (instant) requestAnimationFrame(() => requestAnimationFrame(() => track.classList.remove('no-transition')));
}

function renderDots() {
  const dotsEl = document.getElementById('feat-dots');
  if (!dotsEl) return;
  const cloneCount = Math.min(3, carouselTotal);
  const realIdx = ((carouselIdx - cloneCount) % carouselTotal + carouselTotal) % carouselTotal;
  dotsEl.innerHTML = '';
  for (let i = 0; i < carouselTotal; i++) {
    const dot = document.createElement('button');
    dot.className = 'feat-dot' + (i === realIdx ? ' active' : '');
    dot.setAttribute('aria-label', 'Go to card ' + (i + 1));
    const ci = i;
    dot.onclick = () => {
      carouselIdx = ci + cloneCount;
      carouselGo(carouselIdx, false);
      renderCenter();
      renderDots();
      resetCarouselAuto();
    };
    dotsEl.appendChild(dot);
  }
}

function startCarouselAuto() {
  if (carouselTimer) clearInterval(carouselTimer);
  carouselTimer = setInterval(() => carouselStep(1), 3500);
}
function resetCarouselAuto() {
  if (carouselTimer) clearInterval(carouselTimer);
  startCarouselAuto();
}
window.addEventListener('resize', () => {
  const outer = document.getElementById('feat-carousel-outer');
  if (outer && carouselTotal > 0) initCarousel(carouselTotal, carouselCardW);
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// HOME EDITOR
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let homeData = {};
let editingPostId = null;

function initHomeEditor(page) {
  try { homeData = JSON.parse(page.body || '{}'); } catch { homeData = {}; }
  const def = JSON.parse(defaultHomeBody());
  homeData = Object.assign({}, def, homeData);
  homeData.features = (homeData.features || []).map(f => Object.assign({id:uid(),icon:'â­',img:'',link:'',title:'',desc:''}, f));

  document.getElementById('feat-label').value   = homeData.featLabel   || 'Highlights';
  document.getElementById('feat-heading').value = homeData.featHeading || "What's here for you";
  document.getElementById('video-url').value    = homeData.videoUrl    || '';
  document.getElementById('gallery-heading').value = homeData.galleryHeading || 'Photos';
  document.getElementById('posts-label').value   = homeData.postsLabel   || 'Updates';
  document.getElementById('posts-heading').value = homeData.postsHeading || 'Recent Posts';
  document.getElementById('default-author').value = homeData.defaultAuthor || 'Admin';

  renderFeatureList();
  renderGalleryList();
  renderPostList();
}

function saveHome() {
  homeData.featLabel   = document.getElementById('feat-label').value.trim();
  homeData.featHeading = document.getElementById('feat-heading').value.trim();
  homeData.videoUrl    = document.getElementById('video-url').value.trim();
  homeData.galleryHeading = document.getElementById('gallery-heading').value.trim();
  homeData.postsLabel   = document.getElementById('posts-label').value.trim();
  homeData.postsHeading = document.getElementById('posts-heading').value.trim();
  homeData.defaultAuthor = document.getElementById('default-author').value.trim();
  // Save features from DOM
  document.querySelectorAll('.feat-row').forEach(row => {
    const f = homeData.features.find(f => f.id === row.dataset.fid); if (!f) return;
    f.icon  = row.querySelector('.feat-icon').value.trim();
    f.title = row.querySelector('.feat-title').value.trim();
    f.desc  = row.querySelector('.feat-desc').value.trim();
    f.link  = row.querySelector('.feat-link').value.trim();
  });
  return JSON.stringify(homeData);
}

function addFeatureCard() {
  saveHome();
  homeData.features.push({id:uid(),icon:'â­',img:'',link:'',title:'New Card',desc:'Description here.'});
  renderFeatureList();
}
function delFeatureCard(id) { saveHome(); homeData.features=homeData.features.filter(f=>f.id!==id); renderFeatureList(); }
function moveFeature(id, dir) { saveHome(); const i=homeData.features.findIndex(f=>f.id===id); const ni=i+dir; if(ni<0||ni>=homeData.features.length)return; [homeData.features[i],homeData.features[ni]]=[homeData.features[ni],homeData.features[i]]; renderFeatureList(); }

function setFeatureImg(id) {
  saveHome();
  const url = prompt('Paste image URL:'); if (!url) return;
  const f = homeData.features.find(f=>f.id===id); if (f) f.img = url;
  renderFeatureList();
}
function handleFeaturePhoto(ev, id) {
  const f2=ev.target.files[0]; if(!f2)return;
  const r=new FileReader();
  r.onload=e2=>{ saveHome(); const f=homeData.features.find(f=>f.id===id); if(f)f.img=e2.target.result; renderFeatureList(); };
  r.readAsDataURL(f2); ev.target.value='';
}

function renderFeatureList() {
  const c = document.getElementById('feature-list'); if (!c) return;
  c.innerHTML = '';
  homeData.features.forEach((f, i) => {
    const row = document.createElement('div');
    row.className = 'feat-row'; row.dataset.fid = f.id;
    row.style.cssText = 'background:white;border:1.5px solid var(--border);border-radius:14px;margin-bottom:8px;overflow:hidden;';
    row.innerHTML =
      '<div class="team-card-header">'
        + '<span class="team-card-num">' + esc(f.icon||'') + ' ' + esc(f.title||'Card') + '</span>'
        + '<div style="display:flex;gap:4px">'
          + (i>0?'<button class="ctrl-btn" onclick="moveFeature(\''+f.id+'\',-1)">&#8593;</button>':'')
          + (i<homeData.features.length-1?'<button class="ctrl-btn" onclick="moveFeature(\''+f.id+'\',1)">&#8595;</button>':'')
          + '<button class="ctrl-btn" style="color:#c53030" onclick="delFeatureCard(\''+f.id+'\')">&#128465;</button>'
        + '</div>'
      + '</div>'
      + '<div style="padding:12px 16px;display:grid;grid-template-columns:56px 1fr;gap:8px;align-items:start">'
        + '<div>'
          + '<input class="feat-icon tm-in" type="text" placeholder="ğŸ¤–" value="'+esc(f.icon||'')+'" style="width:100%;text-align:center;font-size:1.2rem">'
          + '<div style="width:100%;aspect-ratio:1;border-radius:8px;border:1px solid var(--border);background-size:cover;background-position:center;margin-top:5px;cursor:pointer;'+(f.img?'background-image:url(\''+esc(f.img)+'\')':'background:var(--g6);display:flex;align-items:center;justify-content:center;font-size:.6rem;color:var(--muted)')+'" onclick="document.getElementById(\'feat-photo-'+f.id+'\').click()">'+(f.img?'':'IMG')+'</div>'
          + '<input type="file" id="feat-photo-'+f.id+'" accept="image/*" style="display:none" onchange="handleFeaturePhoto(event,\''+f.id+'\')">'
        + '</div>'
        + '<div style="display:flex;flex-direction:column;gap:5px">'
          + '<input class="feat-title tm-in" type="text" placeholder="Card title" value="'+esc(f.title||'')+'" style="width:100%">'
          + '<textarea class="feat-desc tm-ta" rows="2" placeholder="Short descriptionâ€¦" style="width:100%">'+esc(f.desc||'')+'</textarea>'
          + '<input class="feat-link tm-in" type="url" placeholder="Link URL (optional)" value="'+esc(f.link||'')+'" style="width:100%">'
        + '</div>'
      + '</div>';
    c.appendChild(row);
  });
}

function addGalleryItem() {
  saveHome();
  const url = prompt('Paste image URL:'); if (!url) return;
  homeData.gallery.push({url, caption:''});
  renderGalleryList();
}
function handleGalleryUpload(ev) {
  const files = ev.target.files; if (!files.length) return;
  saveHome();
  let done = 0;
  Array.from(files).forEach(file => {
    const r = new FileReader();
    r.onload = e => { homeData.gallery.push({url:e.target.result,caption:''}); done++; if(done===files.length) renderGalleryList(); };
    r.readAsDataURL(file);
  });
  ev.target.value = '';
}
function delGalleryItem(i) { saveHome(); homeData.gallery.splice(i,1); renderGalleryList(); }
function renderGalleryList() {
  const c = document.getElementById('gallery-list'); if (!c) return;
  c.innerHTML = '';
  if (!homeData.gallery.length) { c.innerHTML = '<p style="font-size:.8rem;color:var(--muted)">No photos yet.</p>'; return; }
  homeData.gallery.forEach((g, i) => {
    const row = document.createElement('div');
    row.style.cssText = 'display:flex;align-items:center;gap:8px;background:white;border:1.5px solid var(--border);border-radius:10px;padding:8px 12px;margin-bottom:6px;';
    row.innerHTML =
      '<div style="width:56px;height:40px;border-radius:7px;background-size:cover;background-position:center;border:1px solid var(--border);background-image:url(\''+esc(g.url||g)+'\');flex-shrink:0"></div>'
      + '<input type="text" class="tm-in" placeholder="Caption (optional)" value="'+esc(g.caption||'')+'" style="flex:1" oninput="homeData.gallery['+i+'].caption=this.value">'
      + '<button onclick="delGalleryItem('+i+')" style="background:none;border:none;cursor:pointer;color:#c53030;font-size:1rem;padding:4px">&#10005;</button>';
    c.appendChild(row);
  });
}

function addBlogPost() {
  const author = document.getElementById('default-author')?.value?.trim() || 'Admin';
  const p = {id:uid(),title:'New Post',author,date:new Date().toLocaleDateString('en-US',{month:'long',day:'numeric',year:'numeric'}),body:'<p>Write your post here.</p>'};
  homeData.posts = homeData.posts || [];
  homeData.posts.unshift(p);
  editingPostId = p.id;
  openPostEditor(p.id);
  renderPostList();
}
function openPostEditor(id) {
  editingPostId = id;
  const p = homeData.posts.find(p=>p.id===id); if (!p) return;
  document.getElementById('ped-title').value  = p.title  || '';
  document.getElementById('ped-author').value = p.author || homeData.defaultAuthor || 'Admin';
  document.getElementById('ped-date').value   = p.date   || '';
  document.getElementById('post-editor-body').innerHTML = p.body || '';
  openMM('post-editor-modal');
}
function savePostEditor() {
  if (editingBBId) {
    // Build blog post
    const e = bbData.find(e=>e.id===editingBBId);
    if (e) {
      e.title = document.getElementById('ped-title').value.trim() || 'Untitled';
      e.week  = document.getElementById('ped-author').value.trim() || '';
      e.date  = document.getElementById('ped-date').value.trim();
      e.body  = document.getElementById('post-editor-body').innerHTML;
    }
    renderBBList(); closeMM('post-editor-modal'); editingBBId = null;
  } else if (editingPostId) {
    // Home blog post
    const p = homeData.posts.find(p=>p.id===editingPostId);
    if (p) {
      p.title  = document.getElementById('ped-title').value.trim()  || 'Untitled';
      p.author = document.getElementById('ped-author').value.trim() || 'Admin';
      p.date   = document.getElementById('ped-date').value.trim();
      p.body   = document.getElementById('post-editor-body').innerHTML;
    }
    renderPostList(); closeMM('post-editor-modal'); editingPostId = null;
  }
}
function delPost(id) { homeData.posts=homeData.posts.filter(p=>p.id!==id); renderPostList(); }
function movePost(id, dir) { const i=homeData.posts.findIndex(p=>p.id===id); const ni=i+dir; if(ni<0||ni>=homeData.posts.length)return; [homeData.posts[i],homeData.posts[ni]]=[homeData.posts[ni],homeData.posts[i]]; renderPostList(); }
function renderPostList() {
  const c = document.getElementById('post-list'); if (!c) return;
  c.innerHTML = '';
  (homeData.posts||[]).forEach((p,i) => {
    const row = document.createElement('div');
    row.style.cssText = 'background:white;border:1.5px solid var(--border);border-radius:12px;padding:12px 16px;margin-bottom:7px;display:flex;align-items:center;gap:10px;';
    row.innerHTML =
      '<div style="flex:1"><div style="font-weight:700;font-size:.9rem;color:var(--g1)">'+esc(p.title||'')+'</div><div style="font-size:.75rem;color:var(--muted)">'+esc(p.date||'')+(p.author?' Â· '+esc(p.author):'')+'</div></div>'
      + '<div style="display:flex;gap:4px">'
        + (i>0?'<button class="ctrl-btn" onclick="movePost(\''+p.id+'\',-1)">&#8593;</button>':'')
        + (i<(homeData.posts.length-1)?'<button class="ctrl-btn" onclick="movePost(\''+p.id+'\',1)">&#8595;</button>':'')
        + '<button class="ctrl-btn" onclick="openPostEditor(\''+p.id+'\')">&#9998;</button>'
        + '<button class="ctrl-btn" style="color:#c53030" onclick="delPost(\''+p.id+'\')">&#128465;</button>'
      + '</div>';
    c.appendChild(row);
  });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TEAM EDITOR
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let teamData = [];
function initTeamEditor(page) {
  try { teamData = JSON.parse(page.body||'[]'); } catch { teamData=[]; }
  teamData.forEach(m => { if(!m.id) m.id=uid(); if(!m.links) m.links=[]; });
  renderTeamList();
}
function saveTeam() {
  document.querySelectorAll('.team-row').forEach(row => {
    const m = teamData.find(m=>m.id===row.dataset.mid); if (!m) return;
    m.name = row.querySelector('.tm-name').value.trim();
    m.role = row.querySelector('.tm-role').value.trim();
    m.bio  = row.querySelector('.tm-bio').value.trim();
  });
  return JSON.stringify(teamData);
}
function addTeamMember() { saveTeam(); teamData.push({id:uid(),name:'New Member',role:'',bio:'',img:'',links:[]}); renderTeamList(); }
function delTeamMember(id) { saveTeam(); teamData=teamData.filter(m=>m.id!==id); renderTeamList(); }
function moveTeam(id,dir) { saveTeam(); const i=teamData.findIndex(m=>m.id===id); const ni=i+dir; if(ni<0||ni>=teamData.length)return; [teamData[i],teamData[ni]]=[teamData[ni],teamData[i]]; renderTeamList(); }
function setTeamImg(id) { saveTeam(); const url=prompt('Photo URL:'); if(!url)return; const m=teamData.find(m=>m.id===id); if(m)m.img=url; renderTeamList(); }
function handleTeamPhoto(ev,id) { const f=ev.target.files[0]; if(!f)return; const r=new FileReader(); r.onload=e2=>{saveTeam(); const m=teamData.find(m=>m.id===id); if(m)m.img=e2.target.result; renderTeamList();}; r.readAsDataURL(f); ev.target.value=''; }
function addTeamLink(id) { saveTeam(); const m=teamData.find(m=>m.id===id); if(m){m.links=m.links||[];m.links.push({label:'',url:''});} renderTeamList(); }
function delTeamLink(mid,li) { saveTeam(); const m=teamData.find(m=>m.id===mid); if(m)m.links.splice(li,1); renderTeamList(); }
function renderTeamList() {
  const c=document.getElementById('team-list'); if(!c)return; c.innerHTML='';
  teamData.forEach((m,i)=>{
    const row=document.createElement('div');
    row.className='team-row'; row.dataset.mid=m.id;
    row.style.cssText='background:white;border:1.5px solid var(--border);border-radius:14px;margin-bottom:10px;overflow:hidden;';
    row.innerHTML=
      '<div class="team-card-header"><span class="team-card-num">'+(i+1)+'. '+esc(m.name||'Member')+'</span>'
      +'<div style="display:flex;gap:4px">'
        +(i>0?'<button class="ctrl-btn" onclick="moveTeam(\''+m.id+'\',-1)">&#8593;</button>':'')
        +(i<teamData.length-1?'<button class="ctrl-btn" onclick="moveTeam(\''+m.id+'\',1)">&#8595;</button>':'')
        +'<button class="ctrl-btn" style="color:#c53030" onclick="delTeamMember(\''+m.id+'\')">&#128465;</button>'
      +'</div></div>'
      +'<div style="padding:14px 16px;display:grid;grid-template-columns:64px 1fr;gap:12px">'
        +'<div>'
          +'<div style="width:64px;height:64px;border-radius:50%;border:2px solid var(--border);background-size:cover;background-position:center;'+(m.img?'background-image:url(\''+esc(m.img)+'\')':'background:var(--g6);display:flex;align-items:center;justify-content:center;font-size:1.5rem')+'" onclick="document.getElementById(\'tm-photo-'+m.id+'\').click()">'+(m.img?'':'ğŸ‘¤')+'</div>'
          +'<input type="file" id="tm-photo-'+m.id+'" accept="image/*" style="display:none" onchange="handleTeamPhoto(event,\''+m.id+'\')">'
          +'<button class="upload-btn-sm" style="margin-top:5px;width:100%;font-size:.6rem;padding:3px" onclick="setTeamImg(\''+m.id+'\')">URL</button>'
        +'</div>'
        +'<div style="display:flex;flex-direction:column;gap:6px">'
          +'<input class="tm-name tm-in" type="text" placeholder="Name" value="'+esc(m.name||'')+'"><input class="tm-role tm-in" type="text" placeholder="Role/Grade" value="'+esc(m.role||'')+'">'
          +'<textarea class="tm-bio tm-ta" rows="2" placeholder="Short bioâ€¦">'+esc(m.bio||'')+'</textarea>'
          +'<div id="tm-links-'+m.id+'">'+(m.links||[]).map((l,li)=>'<div style="display:flex;gap:4px;margin-bottom:4px"><input type="text" class="tm-in" placeholder="Label" value="'+esc(l.label||'')+'" style="flex:1" oninput="teamData.find(m=>m.id===\''+m.id+'\').links['+li+'].label=this.value"><input type="url" class="tm-in" placeholder="URL" value="'+esc(l.url||'')+'" style="flex:2" oninput="teamData.find(m=>m.id===\''+m.id+'\').links['+li+'].url=this.value"><button onclick="delTeamLink(\''+m.id+'\','+li+')" style="background:none;border:none;cursor:pointer;color:#c53030">&#10005;</button></div>').join('')+'</div>'
          +'<button class="upload-btn-sm" onclick="addTeamLink(\''+m.id+'\')" style="padding:4px 8px;width:fit-content">+ Link</button>'
        +'</div>'
      +'</div>';
    c.appendChild(row);
  });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// RESOURCES EDITOR
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let resData = [];
function initResEditor(page) { try { resData=JSON.parse(page.body||'[]'); } catch { resData=[]; } resData.forEach(r=>{if(!r.id)r.id=uid();}); renderResList(); }
function saveRes() { document.querySelectorAll('.res-row').forEach(row=>{ const r=resData.find(r=>r.id===row.dataset.rid); if(!r)return; r.category=row.querySelector('.res-cat').value.trim(); r.title=row.querySelector('.res-title').value.trim(); r.description=row.querySelector('.res-desc').value.trim(); r.url=row.querySelector('.res-url').value.trim(); }); return JSON.stringify(resData); }
function addResource() { saveRes(); resData.push({id:uid(),category:'General',title:'New Resource',description:'',url:'',img:''}); renderResList(); }
function delResource(id) { saveRes(); resData=resData.filter(r=>r.id!==id); renderResList(); }
function setResImg(id) { saveRes(); const url=prompt('Image URL:'); if(!url)return; const r=resData.find(r=>r.id===id); if(r)r.img=url; renderResList(); }
function renderResList() {
  const c=document.getElementById('res-list'); if(!c)return; c.innerHTML='';
  resData.forEach((r,i)=>{
    const row=document.createElement('div'); row.className='res-row'; row.dataset.rid=r.id;
    row.style.cssText='background:white;border:1.5px solid var(--border);border-radius:12px;padding:12px 16px;margin-bottom:7px;';
    row.innerHTML='<div style="display:grid;grid-template-columns:1fr 1fr;gap:6px;margin-bottom:6px">'
      +'<input class="res-cat tm-in" type="text" placeholder="Category" value="'+esc(r.category||'')+'">'
      +'<input class="res-title tm-in" type="text" placeholder="Title" value="'+esc(r.title||'')+'">'
      +'<input class="res-url tm-in" type="url" placeholder="URL" value="'+esc(r.url||'')+'" style="grid-column:1/-1">'
      +'<input class="res-desc tm-in" type="text" placeholder="Description" value="'+esc(r.description||'')+'" style="grid-column:1/-1">'
      +'</div>'
      +'<div style="display:flex;gap:8px;align-items:center">'
        +(r.img?'<div style="width:44px;height:32px;border-radius:6px;background-size:cover;background-position:center;background-image:url(\''+esc(r.img)+'\');border:1px solid var(--border)"></div>':'')
        +'<button class="upload-btn-sm" onclick="setResImg(\''+r.id+'\')" style="padding:4px 9px">&#128279; IMG</button>'
        +'<button class="ctrl-btn" style="color:#c53030;margin-left:auto" onclick="delResource(\''+r.id+'\')">&#128465;</button>'
      +'</div>';
    c.appendChild(row);
  });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// EVENTS EDITOR
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let eventsData = [];
function initEventsEditor(page) { try { eventsData=JSON.parse(page.body||'[]'); } catch { eventsData=[]; } eventsData.forEach(e=>{if(!e.id)e.id=uid();}); renderEventsList(); }
function saveEvents() { document.querySelectorAll('.ev-row').forEach(row=>{ const e=eventsData.find(e=>e.id===row.dataset.eid); if(!e)return; e.date=row.querySelector('.ev-date').value.trim(); e.title=row.querySelector('.ev-title').value.trim(); e.desc=row.querySelector('.ev-desc').value.trim(); e.location=row.querySelector('.ev-location').value.trim(); e.link=row.querySelector('.ev-link').value.trim(); e.linkLabel=row.querySelector('.ev-link-label').value.trim(); }); return JSON.stringify(eventsData); }
function addEvent() { saveEvents(); eventsData.push({id:uid(),date:'',title:'New Event',desc:'',location:'',img:'',link:'',linkLabel:'Learn More'}); renderEventsList(); }
function delEvent(id) { saveEvents(); eventsData=eventsData.filter(e=>e.id!==id); renderEventsList(); }
function moveEvent(id,dir) { saveEvents(); const i=eventsData.findIndex(e=>e.id===id); const ni=i+dir; if(ni<0||ni>=eventsData.length)return; [eventsData[i],eventsData[ni]]=[eventsData[ni],eventsData[i]]; renderEventsList(); }
function setEventImg(id) { saveEvents(); const url=prompt('Photo URL:'); if(!url)return; const e=eventsData.find(e=>e.id===id); if(e)e.img=url; renderEventsList(); }
function handleEventPhoto(ev,id) { const f=ev.target.files[0]; if(!f)return; const r=new FileReader(); r.onload=e2=>{saveEvents(); const e=eventsData.find(e=>e.id===id); if(e)e.img=e2.target.result; renderEventsList();}; r.readAsDataURL(f); ev.target.value=''; }
function renderEventsList() {
  const c=document.getElementById('events-list'); if(!c)return; c.innerHTML='';
  eventsData.forEach((e,i)=>{
    const row=document.createElement('div'); row.className='ev-row'; row.dataset.eid=e.id;
    row.style.cssText='background:white;border:1.5px solid var(--border);border-radius:14px;margin-bottom:10px;overflow:hidden;';
    row.innerHTML='<div class="team-card-header"><span class="team-card-num">'+(i+1)+'. '+esc(e.title||'Event')+'</span>'
      +'<div style="display:flex;gap:4px">'
        +(i>0?'<button class="ctrl-btn" onclick="moveEvent(\''+e.id+'\',-1)">&#8593;</button>':'')
        +(i<eventsData.length-1?'<button class="ctrl-btn" onclick="moveEvent(\''+e.id+'\',1)">&#8595;</button>':'')
        +'<button class="ctrl-btn" style="color:#c53030" onclick="delEvent(\''+e.id+'\')">&#128465;</button>'
      +'</div></div>'
      +'<div style="padding:14px 16px;display:grid;grid-template-columns:1fr 1fr;gap:8px">'
        +'<div><label class="tm-lbl">Date</label><input class="ev-date tm-in" type="text" placeholder="March 15, 2026" value="'+esc(e.date||'')+'"></div>'
        +'<div><label class="tm-lbl">Location</label><input class="ev-location tm-in" type="text" placeholder="City, State" value="'+esc(e.location||'')+'"></div>'
        +'<div style="grid-column:1/-1"><label class="tm-lbl">Title</label><input class="ev-title tm-in" type="text" placeholder="Event title" value="'+esc(e.title||'')+'" style="width:100%"></div>'
        +'<div style="grid-column:1/-1"><label class="tm-lbl">Description</label><textarea class="ev-desc tm-ta" rows="2" style="width:100%">'+esc(e.desc||'')+'</textarea></div>'
        +'<div><label class="tm-lbl">Link URL</label><input class="ev-link tm-in" type="url" placeholder="https://â€¦" value="'+esc(e.link||'')+'"></div>'
        +'<div><label class="tm-lbl">Button Label</label><input class="ev-link-label tm-in" type="text" placeholder="Get Tickets" value="'+esc(e.linkLabel||'Learn More')+'"></div>'
        +'<div style="grid-column:1/-1;display:flex;align-items:center;gap:8px">'
          +(e.img?'<div style="width:56px;height:40px;border-radius:7px;border:1.5px solid var(--border);background-size:cover;background-position:center;background-image:url(\''+esc(e.img)+'\');flex-shrink:0"></div>':'')
          +'<input type="file" id="ev-file-'+e.id+'" accept="image/*" style="display:none" onchange="handleEventPhoto(event,\''+e.id+'\')">'
          +'<button class="upload-btn-sm" onclick="document.getElementById(\'ev-file-'+e.id+'\').click()" style="padding:5px 10px">&#128193; Photo</button>'
          +'<button class="upload-btn-sm" onclick="setEventImg(\''+e.id+'\')" style="padding:5px 10px">&#128279; URL</button>'
        +'</div>'
      +'</div>';
    c.appendChild(row);
  });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// BUILD SEASON BLOG
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let bbData = [];
let editingBBId = null;

function initBuildBlog(page) {
  try { bbData=JSON.parse(page.body||'[]'); } catch { bbData=[]; }
  if (!bbData.length) bbData=[{id:uid(),week:'Week 1',date:'',title:'Kickoff',body:'<p>Write your update here.</p>',imgs:[],tags:''}];
  bbData.forEach(e=>{if(!e.id)e.id=uid(); if(!e.imgs)e.imgs=[];});
  renderBBList();
}
function saveBuildBlog() {
  document.querySelectorAll('.bb-row').forEach(row=>{
    const e=bbData.find(e=>e.id===row.dataset.bid); if(!e)return;
    e.week=row.querySelector('.bb-week').value.trim();
    e.date=row.querySelector('.bb-date').value.trim();
    e.title=row.querySelector('.bb-title').value.trim();
    e.tags=row.querySelector('.bb-tags').value.trim();
  });
  return JSON.stringify(bbData);
}
function addBuildPost() {
  saveBuildBlog();
  const p={id:uid(),week:'Week '+(bbData.length+1),date:'',title:'New Update',body:'<p>Write your update here.</p>',imgs:[],tags:''};
  bbData.unshift(p); renderBBList(); setTimeout(()=>openBBEditor(p.id),60);
}
function delBuildPost(id) { saveBuildBlog(); bbData=bbData.filter(e=>e.id!==id); renderBBList(); }
function moveBB(id,dir) { saveBuildBlog(); const i=bbData.findIndex(e=>e.id===id); const ni=i+dir; if(ni<0||ni>=bbData.length)return; [bbData[i],bbData[ni]]=[bbData[ni],bbData[i]]; renderBBList(); }
function openBBEditor(id) {
  editingBBId=id; const e=bbData.find(e=>e.id===id); if(!e)return;
  document.getElementById('ped-title').value=e.title||'';
  document.getElementById('ped-author').value=e.week||'';
  document.getElementById('ped-date').value=e.date||'';
  document.getElementById('post-editor-body').innerHTML=e.body||'';
  openMM('post-editor-modal');
}
function triggerBBPhoto(id) { const inp=document.getElementById('bb-file-'+id); if(inp)inp.click(); }
function addBBPhoto(id) { saveBuildBlog(); const url=prompt('Paste image URL:'); if(!url)return; const e=bbData.find(e=>e.id===id); if(e)e.imgs.push(url); renderBBList(); }
function delBBPhoto(id,idx) { saveBuildBlog(); const e=bbData.find(e=>e.id===id); if(e)e.imgs.splice(idx,1); renderBBList(); }
function handleBBPhoto(ev,id) { const f=ev.target.files[0]; if(!f)return; const r=new FileReader(); r.onload=e2=>{saveBuildBlog(); const en=bbData.find(e=>e.id===id); if(en)en.imgs.push(e2.target.result); renderBBList();}; r.readAsDataURL(f); ev.target.value=''; }
function renderBBList() {
  const c=document.getElementById('buildblog-list'); if(!c)return; c.innerHTML='';
  bbData.forEach((e,i)=>{
    const row=document.createElement('div'); row.className='bb-row'; row.dataset.bid=e.id;
    row.style.cssText='background:white;border:1.5px solid var(--border);border-radius:14px;margin-bottom:12px;overflow:hidden;';
    const thumbsHTML=(e.imgs||[]).map((img,ii)=>'<div style="position:relative;display:inline-block;margin-right:6px"><img src="'+esc(img)+'" style="width:54px;height:40px;object-fit:cover;border-radius:6px;border:1px solid var(--border)"><button onclick="delBBPhoto(\''+e.id+'\','+ii+')" style="position:absolute;top:-5px;right:-5px;background:#c53030;color:white;border:none;border-radius:50%;width:16px;height:16px;font-size:.6rem;cursor:pointer;line-height:1;padding:0">&#10005;</button></div>').join('');
    row.innerHTML='<div class="team-card-header"><span class="team-card-num">'+(i+1)+'. '+esc(e.title||'Update')+'</span><div style="display:flex;gap:4px">'+(i>0?'<button class="ctrl-btn" onclick="moveBB(\''+e.id+'\',-1)">&#8593;</button>':'')+(i<bbData.length-1?'<button class="ctrl-btn" onclick="moveBB(\''+e.id+'\',1)">&#8595;</button>':'')+'<button class="ctrl-btn" onclick="openBBEditor(\''+e.id+'\')">&#9998; Edit</button><button class="ctrl-btn" style="color:#c53030" onclick="delBuildPost(\''+e.id+'\')">&#128465;</button></div></div>'
      +'<div style="padding:14px 16px;display:flex;flex-direction:column;gap:8px"><div style="display:flex;gap:8px;flex-wrap:wrap"><div style="flex:1;min-width:90px"><label class="tm-lbl">Week</label><input class="bb-week tm-in" type="text" placeholder="Week 1" value="'+esc(e.week||'')+'"></div><div style="flex:1;min-width:110px"><label class="tm-lbl">Date</label><input class="bb-date tm-in" type="text" placeholder="Jan 6, 2026" value="'+esc(e.date||'')+'"></div><div style="flex:2;min-width:150px"><label class="tm-lbl">Title</label><input class="bb-title tm-in" type="text" placeholder="Update title" value="'+esc(e.title||'')+'"></div></div><div><label class="tm-lbl">Tags</label><input class="bb-tags tm-in" type="text" placeholder="drivetrain, programming" value="'+esc(e.tags||'')+'" style="width:100%"></div><div><label class="tm-lbl">Photos</label><div style="display:flex;align-items:center;gap:8px;flex-wrap:wrap;margin-top:4px">'+thumbsHTML+'<button class="upload-btn-sm" onclick="triggerBBPhoto(\''+e.id+'\')" style="padding:5px 10px">&#128193;</button><button class="upload-btn-sm" onclick="addBBPhoto(\''+e.id+'\')" style="padding:5px 10px">&#128279;</button><input type="file" id="bb-file-'+e.id+'" accept="image/*" style="display:none" onchange="handleBBPhoto(event,\''+e.id+'\')"></div></div></div>';
    c.appendChild(row);
  });
}
function renderBuildBlogPublic(body) {
  let entries; try { entries=JSON.parse(body||'[]'); } catch { entries=[]; }
  if (!entries.length) return '<p style="color:var(--muted);text-align:center;padding:40px"><em>No build updates yet.</em></p>';
  return '<div class="pub-bb-list">'+entries.map(e=>{
    const tags=(e.tags||'').split(',').map(t=>t.trim()).filter(Boolean);
    const imgs=e.imgs||[];
    return '<div class="pub-bb-entry"><div class="pub-bb-header">'+(e.week?'<div class="pub-bb-week">'+esc(e.week)+'</div>':'')+'<div class="pub-bb-title">'+esc(e.title||'Update')+'</div>'+(e.date?'<div class="pub-bb-date">'+esc(e.date)+'</div>':'')+'</div><div class="pub-bb-body">'+(e.body||'')+'</div>'+(imgs.length?'<div class="pub-bb-imgs">'+imgs.map(img=>'<img class="pub-bb-img" src="'+esc(img)+'" alt="">').join('')+'</div>':'')+(tags.length?'<div class="pub-bb-tags">'+tags.map(t=>'<span class="pub-bb-tag">'+esc(t)+'</span>').join('')+'</div>':'')+'</div>';
  }).join('')+'</div>';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// MATCH VIDEOS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let mvData = [];
function initMatchVideos(page) { try { mvData=JSON.parse(page.body||'[]'); } catch { mvData=[]; } if(!mvData.length) mvData=[{id:uid(),event:'',match:'',url:'',notes:''}]; mvData.forEach(v=>{if(!v.id)v.id=uid();}); renderMVList(); }
function saveMatchVideos() { document.querySelectorAll('.mv-row').forEach(row=>{ const v=mvData.find(v=>v.id===row.dataset.vid); if(!v)return; v.event=row.querySelector('.mv-event').value.trim(); v.match=row.querySelector('.mv-match').value.trim(); v.url=row.querySelector('.mv-url').value.trim(); v.notes=row.querySelector('.mv-notes').value.trim(); }); return JSON.stringify(mvData); }
function addMatchVideo() { saveMatchVideos(); mvData.push({id:uid(),event:'',match:'New Match',url:'',notes:''}); renderMVList(); }
function delMatchVideo(id) { saveMatchVideos(); mvData=mvData.filter(v=>v.id!==id); renderMVList(); }
function moveMV(id,dir) { saveMatchVideos(); const i=mvData.findIndex(v=>v.id===id); const ni=i+dir; if(ni<0||ni>=mvData.length)return; [mvData[i],mvData[ni]]=[mvData[ni],mvData[i]]; renderMVList(); }
function renderMVList() {
  const c=document.getElementById('matchvideos-list'); if(!c)return; c.innerHTML='';
  mvData.forEach((v,i)=>{
    const row=document.createElement('div'); row.className='mv-row'; row.dataset.vid=v.id;
    row.style.cssText='background:white;border:1.5px solid var(--border);border-radius:14px;margin-bottom:10px;overflow:hidden;';
    row.innerHTML='<div class="team-card-header"><span class="team-card-num">Video '+(i+1)+(v.match?' &#8212; '+esc(v.match):'')+'</span><div style="display:flex;gap:4px">'+(i>0?'<button class="ctrl-btn" onclick="moveMV(\''+v.id+'\',-1)">&#8593;</button>':'')+(i<mvData.length-1?'<button class="ctrl-btn" onclick="moveMV(\''+v.id+'\',1)">&#8595;</button>':'')+'<button class="ctrl-btn" style="color:#c53030" onclick="delMatchVideo(\''+v.id+'\')">&#128465;</button></div></div>'
      +'<div style="padding:14px 16px;display:flex;flex-direction:column;gap:8px"><div style="display:flex;gap:8px;flex-wrap:wrap"><div style="flex:2;min-width:140px"><label class="tm-lbl">Event</label><input class="mv-event tm-in" type="text" placeholder="State Championship" value="'+esc(v.event||'')+'"></div><div style="flex:1;min-width:100px"><label class="tm-lbl">Match</label><input class="mv-match tm-in" type="text" placeholder="Qual 12" value="'+esc(v.match||'')+'"></div></div><div><label class="tm-lbl">YouTube / Vimeo URL</label><input class="mv-url tm-in" type="url" placeholder="https://youtube.com/watch?v=â€¦" value="'+esc(v.url||'')+'" style="width:100%"></div><div><label class="tm-lbl">Notes</label><input class="mv-notes tm-in" type="text" placeholder="Won by 20 pts, auto worked great" value="'+esc(v.notes||'')+'" style="width:100%"></div></div>';
    c.appendChild(row);
  });
}
function renderMatchVideosPublic(body) {
  let videos; try { videos=JSON.parse(body||'[]'); } catch { videos=[]; }
  if (!videos.length) return '<p style="color:var(--muted);text-align:center;padding:40px"><em>No match videos yet.</em></p>';
  return '<div class="pub-mv-grid">'+videos.map(v=>{
    const embed=videoEmbedUrl(v.url||'');
    const videoEl=embed?'<div class="pub-mv-embed"><iframe src="'+embed+'" allowfullscreen allow="accelerometer;autoplay;clipboard-write;encrypted-media;gyroscope;picture-in-picture"></iframe></div>':'<div class="pub-mv-embed" style="display:flex;align-items:center;justify-content:center;background:var(--g1)"><span style="color:rgba(255,255,255,.4);font-size:.9rem">No video linked</span></div>';
    return '<div class="pub-mv-card">'+videoEl+'<div class="pub-mv-info">'+(v.event?'<div class="pub-mv-event">'+esc(v.event)+'</div>':'')+'<div class="pub-mv-match">'+esc(v.match||'Match')+'</div>'+(v.notes?'<div class="pub-mv-notes">'+esc(v.notes)+'</div>':'')+'</div></div>';
  }).join('')+'</div>';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// COMPETITION SCHEDULE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let csData={season:'',events:[]};
function initCompSchedule(page) { try { csData=JSON.parse(page.body||'{}'); } catch { csData={}; } if(!csData.events)csData.events=[]; if(!csData.season)csData.season=''; csData.events.forEach(e=>{if(!e.id)e.id=uid(); if(!e.status)e.status='upcoming';}); document.getElementById('cs-season').value=csData.season||''; renderCSList(); }
function saveCompSchedule() { csData.season=(document.getElementById('cs-season')||{value:''}).value.trim(); document.querySelectorAll('.cs-row').forEach(row=>{ const e=csData.events.find(e=>e.id===row.dataset.cid); if(!e)return; e.name=row.querySelector('.cs-name').value.trim(); e.date=row.querySelector('.cs-date').value.trim(); e.location=row.querySelector('.cs-loc').value.trim(); e.status=row.querySelector('.cs-status').value; e.rank=row.querySelector('.cs-rank').value.trim(); e.record=row.querySelector('.cs-record').value.trim(); e.link=row.querySelector('.cs-link').value.trim(); e.img=row.querySelector('.cs-img-val').value.trim(); }); return JSON.stringify(csData); }
function addCompEvent() { saveCompSchedule(); csData.events.push({id:uid(),name:'New Competition',date:'',location:'',status:'upcoming',rank:'',record:'',link:'',img:''}); renderCSList(); }
function delCompEvent(id) { saveCompSchedule(); csData.events=csData.events.filter(e=>e.id!==id); renderCSList(); }
function moveCS(id,dir) { saveCompSchedule(); const i=csData.events.findIndex(e=>e.id===id); const ni=i+dir; if(ni<0||ni>=csData.events.length)return; [csData.events[i],csData.events[ni]]=[csData.events[ni],csData.events[i]]; renderCSList(); }
function setCSImg(id) { saveCompSchedule(); const url=prompt('Paste image URL:'); if(!url)return; const e=csData.events.find(e=>e.id===id); if(e)e.img=url; renderCSList(); }
function handleCSPhoto(ev,id) { const f=ev.target.files[0]; if(!f)return; const r=new FileReader(); r.onload=e2=>{saveCompSchedule(); const e=csData.events.find(e=>e.id===id); if(e)e.img=e2.target.result; renderCSList();}; r.readAsDataURL(f); ev.target.value=''; }
function renderCSList() {
  const c=document.getElementById('compschedule-list'); if(!c)return; c.innerHTML='';
  csData.events.forEach((e,i)=>{
    const row=document.createElement('div'); row.className='cs-row'; row.dataset.cid=e.id;
    row.style.cssText='background:white;border:1.5px solid var(--border);border-radius:14px;margin-bottom:10px;overflow:hidden;';
    row.innerHTML='<div class="team-card-header"><span class="team-card-num">'+(i+1)+'. '+esc(e.name||'Competition')+'</span><div style="display:flex;gap:4px">'+(i>0?'<button class="ctrl-btn" onclick="moveCS(\''+e.id+'\',-1)">&#8593;</button>':'')+(i<csData.events.length-1?'<button class="ctrl-btn" onclick="moveCS(\''+e.id+'\',1)">&#8595;</button>':'')+'<button class="ctrl-btn" style="color:#c53030" onclick="delCompEvent(\''+e.id+'\')">&#128465;</button></div></div>'
      +'<div style="padding:14px 16px;display:grid;grid-template-columns:1fr 1fr;gap:8px"><div style="grid-column:1/-1"><label class="tm-lbl">Event Name</label><input class="cs-name tm-in" type="text" placeholder="Regional Championship" value="'+esc(e.name||'')+'" style="width:100%"></div><div><label class="tm-lbl">Date(s)</label><input class="cs-date tm-in" type="text" placeholder="March 8-10, 2026" value="'+esc(e.date||'')+'"></div><div><label class="tm-lbl">Location</label><input class="cs-loc tm-in" type="text" placeholder="City, State" value="'+esc(e.location||'')+'"></div><div><label class="tm-lbl">Status</label><select class="cs-status tm-in" style="width:100%"><option value="upcoming"'+(e.status==='upcoming'?' selected':'')+'>Upcoming</option><option value="active"'+(e.status==='active'?' selected':'')+'>In Progress</option><option value="past"'+(e.status==='past'?' selected':'')+'>Completed</option></select></div><div><label class="tm-lbl">Our Rank</label><input class="cs-rank tm-in" type="text" placeholder="e.g. 3rd" value="'+esc(e.rank||'')+'"></div><div><label class="tm-lbl">Record</label><input class="cs-record tm-in" type="text" placeholder="7-2-0" value="'+esc(e.record||'')+'"></div><div style="grid-column:1/-1"><label class="tm-lbl">Info URL</label><input class="cs-link tm-in" type="url" placeholder="https://â€¦" value="'+esc(e.link||'')+'" style="width:100%"></div><div style="grid-column:1/-1;display:flex;align-items:center;gap:8px">'+(e.img?'<div style="width:56px;height:40px;border-radius:7px;border:1.5px solid var(--border);background-size:cover;background-position:center;flex-shrink:0;background-image:url(\''+esc(e.img)+'\')"></div>':'')+'<input type="hidden" class="cs-img-val" value="'+esc(e.img||'')+'"><input type="file" id="cs-file-'+e.id+'" accept="image/*" style="display:none" onchange="handleCSPhoto(event,\''+e.id+'\')"><button class="upload-btn-sm" onclick="document.getElementById(\'cs-file-'+e.id+'\').click()" style="padding:5px 10px">&#128193;</button><button class="upload-btn-sm" onclick="setCSImg(\''+e.id+'\')" style="padding:5px 10px">&#128279;</button></div></div>';
    c.appendChild(row);
  });
}
function renderCompSchedulePublic(body) {
  let data; try { data=JSON.parse(body||'{}'); } catch { data={}; }
  const events=data.events||[];
  if (!events.length) return '<p style="color:var(--muted);text-align:center;padding:40px"><em>No competitions scheduled yet.</em></p>';
  return (data.season?'<div class="pub-cs-season">Season: '+esc(data.season)+'</div>':'')+'<div class="pub-cs-list">'+events.map(e=>{
    const st=e.status||'upcoming';
    return '<div class="pub-cs-card"><div class="pub-cs-status-bar '+st+'"></div>'+(e.img?'<div class="pub-cs-img" style="background-image:url(\''+esc(e.img)+'\')"></div>':'<div class="pub-cs-img">&#127942;</div>')+'<div class="pub-cs-body"><span class="pub-cs-badge '+st+'">'+(st==='upcoming'?'Upcoming':st==='active'?'In Progress':'Completed')+'</span><div class="pub-cs-name">'+esc(e.name||'Competition')+'</div>'+(e.date?'<div class="pub-cs-date">&#128197; '+esc(e.date)+'</div>':'')+(e.location?'<div class="pub-cs-location">&#128205; '+esc(e.location)+'</div>':'')+(e.rank||e.record?'<div class="pub-cs-record">'+(e.rank?'Rank: '+esc(e.rank):'')+(e.rank&&e.record?' &middot; ':'')+(e.record?'Record: '+esc(e.record):'')+'</div>':'')+(e.link?'<a class="pub-cs-link" href="'+esc(e.link)+'" target="_blank" rel="noopener">More Info &#8594;</a>':'')+'</div></div>';
  }).join('')+'</div>';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ROBOT SHOWCASE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let rsData={};
function initRobotShowcase(page) { try { rsData=JSON.parse(page.body||'{}'); } catch { rsData={}; } if(!rsData.specs)rsData.specs=[{id:uid(),label:'',value:''}]; if(!rsData.features)rsData.features=[{id:uid(),title:'',desc:'',img:''}]; if(!rsData.gallery)rsData.gallery=[]; rsData.specs.forEach(s=>{if(!s.id)s.id=uid();}); rsData.features.forEach(f=>{if(!f.id)f.id=uid();}); document.getElementById('rs-name').value=rsData.robotName||''; document.getElementById('rs-year').value=rsData.year||''; document.getElementById('rs-tagline').value=rsData.tagline||''; document.getElementById('rs-main-img').value=rsData.mainImg||''; const prev=document.getElementById('rs-main-img-prev'); if(prev&&rsData.mainImg){prev.style.backgroundImage='url(\''+rsData.mainImg+'\')';prev.style.backgroundSize='cover';prev.textContent='';} renderRsSpecs(); renderRsFeatures(); renderRsGallery(); }
function saveRobotShowcase() { rsData.robotName=document.getElementById('rs-name').value.trim(); rsData.year=document.getElementById('rs-year').value.trim(); rsData.tagline=document.getElementById('rs-tagline').value.trim(); rsData.mainImg=document.getElementById('rs-main-img').value.trim(); document.querySelectorAll('.rs-spec-row').forEach(row=>{const s=rsData.specs.find(s=>s.id===row.dataset.sid);if(!s)return;s.label=row.querySelector('.rs-s-label').value.trim();s.value=row.querySelector('.rs-s-val').value.trim();}); document.querySelectorAll('.rs-feat-row').forEach(row=>{const f=rsData.features.find(f=>f.id===row.dataset.fid);if(!f)return;f.title=row.querySelector('.rs-f-title').value.trim();f.desc=row.querySelector('.rs-f-desc').value.trim();f.img=row.querySelector('.rs-f-img-val').value.trim();}); return JSON.stringify(rsData); }
function setRsMainUrl() { const url=prompt('Paste main robot image URL:'); if(!url)return; rsData.mainImg=url; document.getElementById('rs-main-img').value=url; const prev=document.getElementById('rs-main-img-prev'); if(prev){prev.style.backgroundImage='url(\''+url+'\')';prev.style.backgroundSize='cover';prev.textContent='';} }
function handleRsMainPhoto(ev) { const f=ev.target.files[0]; if(!f)return; const r=new FileReader(); r.onload=e2=>{rsData.mainImg=e2.target.result;document.getElementById('rs-main-img').value=e2.target.result;const prev=document.getElementById('rs-main-img-prev');if(prev){prev.style.backgroundImage='url(\''+e2.target.result+'\')';prev.style.backgroundSize='cover';prev.textContent='';}};r.readAsDataURL(f);ev.target.value=''; }
function addRsSpec() { saveRobotShowcase(); rsData.specs.push({id:uid(),label:'',value:''}); renderRsSpecs(); }
function delRsSpec(id) { saveRobotShowcase(); rsData.specs=rsData.specs.filter(s=>s.id!==id); renderRsSpecs(); }
function renderRsSpecs() { const c=document.getElementById('rs-specs-list'); if(!c)return; c.innerHTML=''; rsData.specs.forEach(s=>{const row=document.createElement('div'); row.className='rs-spec-row'; row.dataset.sid=s.id; row.style.cssText='display:flex;gap:8px;align-items:center;margin-bottom:7px;'; row.innerHTML='<input class="rs-s-label tm-in" type="text" placeholder="Label e.g. Weight" value="'+esc(s.label||'')+'" style="flex:1"><input class="rs-s-val tm-in" type="text" placeholder="Value e.g. 28 lbs" value="'+esc(s.value||'')+'" style="flex:2"><button onclick="delRsSpec(\''+s.id+'\')" style="background:none;border:none;cursor:pointer;color:#c53030;font-size:1rem;padding:4px">&#10005;</button>'; c.appendChild(row);}); }
function addRsFeature() { saveRobotShowcase(); rsData.features.push({id:uid(),title:'',desc:'',img:''}); renderRsFeatures(); }
function delRsFeature(id) { saveRobotShowcase(); rsData.features=rsData.features.filter(f=>f.id!==id); renderRsFeatures(); }
function setRsFeatureImg(id) { saveRobotShowcase(); const url=prompt('Paste image URL:'); if(!url)return; const f=rsData.features.find(f=>f.id===id); if(f)f.img=url; renderRsFeatures(); }
function handleRsFeatPhoto(ev,id) { const f2=ev.target.files[0]; if(!f2)return; const r=new FileReader(); r.onload=e2=>{saveRobotShowcase();const f=rsData.features.find(f=>f.id===id);if(f)f.img=e2.target.result;renderRsFeatures();};r.readAsDataURL(f2);ev.target.value=''; }
function renderRsFeatures() { const c=document.getElementById('rs-features-list'); if(!c)return; c.innerHTML=''; rsData.features.forEach(f=>{const row=document.createElement('div'); row.className='rs-feat-row'; row.dataset.fid=f.id; row.style.cssText='background:var(--g6);border:1.5px solid var(--border);border-radius:12px;padding:12px 14px;margin-bottom:8px;'; row.innerHTML='<div style="display:flex;gap:8px;align-items:flex-start"><div style="display:flex;flex-direction:column;gap:6px;flex:1"><input class="rs-f-title tm-in" type="text" placeholder="Feature name" value="'+esc(f.title||'')+'" style="width:100%"><textarea class="rs-f-desc tm-ta" rows="2" placeholder="Describeâ€¦" style="width:100%">'+esc(f.desc||'')+'</textarea><div style="display:flex;gap:6px;align-items:center">'+(f.img?'<div style="width:48px;height:34px;border-radius:6px;background-size:cover;background-position:center;border:1px solid var(--border);background-image:url(\''+esc(f.img)+'\');flex-shrink:0"></div>':'')+'<input type="hidden" class="rs-f-img-val" value="'+esc(f.img||'')+'"><input type="file" id="rs-ff-'+f.id+'" accept="image/*" style="display:none" onchange="handleRsFeatPhoto(event,\''+f.id+'\')"><button class="upload-btn-sm" onclick="document.getElementById(\'rs-ff-'+f.id+'\').click()" style="padding:4px 9px">&#128193;</button><button class="upload-btn-sm" onclick="setRsFeatureImg(\''+f.id+'\')" style="padding:4px 9px">&#128279;</button></div></div><button onclick="delRsFeature(\''+f.id+'\')" style="background:none;border:none;cursor:pointer;color:#c53030;font-size:1rem;padding:4px;flex-shrink:0">&#10005;</button></div>'; c.appendChild(row);}); }
function addRsGalleryPhoto() { saveRobotShowcase(); const url=prompt('Paste image URL:'); if(!url)return; rsData.gallery.push(url); renderRsGallery(); }
function handleRsGallery(ev) { const f=ev.target.files[0]; if(!f)return; const r=new FileReader(); r.onload=e2=>{saveRobotShowcase();rsData.gallery.push(e2.target.result);renderRsGallery();};r.readAsDataURL(f);ev.target.value=''; }
function delRsGalleryPhoto(i) { saveRobotShowcase(); rsData.gallery.splice(i,1); renderRsGallery(); }
function renderRsGallery() { const c=document.getElementById('rs-gallery-list'); if(!c)return; c.innerHTML=''; if(!rsData.gallery.length){c.innerHTML='<p style="font-size:.8rem;color:var(--muted);margin-bottom:8px">No gallery photos yet.</p>';}else{const wrap=document.createElement('div');wrap.style.cssText='display:flex;flex-wrap:wrap;gap:8px;margin-bottom:10px;';rsData.gallery.forEach((img,i)=>{const div=document.createElement('div');div.style.cssText='position:relative;';div.innerHTML='<img src="'+esc(img)+'" style="width:72px;height:52px;object-fit:cover;border-radius:8px;border:1.5px solid var(--border)"><button onclick="delRsGalleryPhoto('+i+')" style="position:absolute;top:-5px;right:-5px;background:#c53030;color:white;border:none;border-radius:50%;width:16px;height:16px;font-size:.6rem;cursor:pointer;line-height:1;padding:0">&#10005;</button>';wrap.appendChild(div);});c.appendChild(wrap);}const addRow=document.createElement('div');addRow.style.cssText='display:flex;gap:8px;';addRow.innerHTML='<button class="upload-btn-sm" onclick="document.getElementById(\'rs-gal-file\').click()" style="padding:5px 12px">&#128193; Upload</button><button class="upload-btn-sm" onclick="addRsGalleryPhoto()" style="padding:5px 12px">&#128279; URL</button><input type="file" id="rs-gal-file" accept="image/*" style="display:none" onchange="handleRsGallery(event)">';c.appendChild(addRow); }
function renderRobotShowcasePublic(body) {
  let d; try { d=JSON.parse(body||'{}'); } catch { d={}; }
  const specs=(d.specs||[]).filter(s=>s.label&&s.value);
  const features=d.features||[];
  const gallery=d.gallery||[];
  return '<div class="pub-rs-hero"><div class="pub-rs-mainimg" style="'+(d.mainImg?'background-image:url(\''+esc(d.mainImg)+'\')':'background:var(--g5)')+'">'+(d.mainImg?'':'&#129302;')+'</div><div class="pub-rs-info">'+(d.year?'<div class="pub-rs-year">'+esc(d.year)+' Season</div>':'')+'<div class="pub-rs-rname">'+esc(d.robotName||'Our Robot')+'</div>'+(d.tagline?'<div class="pub-rs-tagline">'+esc(d.tagline)+'</div>':'')+(specs.length?'<div class="pub-rs-specs">'+specs.map(s=>'<div class="pub-rs-spec"><div class="pub-rs-spec-label">'+esc(s.label)+'</div><div class="pub-rs-spec-val">'+esc(s.value)+'</div></div>').join('')+'</div>':'')+'</div></div>'
    +(features.length?'<h2 style="font-family:\'Playfair Display\',serif;color:var(--g1);font-size:1.5rem;margin-bottom:18px;">Robot Features</h2><div class="pub-rs-features">'+features.map(f=>'<div class="pub-rs-feat"><div class="pub-rs-feat-img" style="'+(f.img?'background-image:url(\''+esc(f.img)+'\')':'background:var(--g5)')+'">'+(f.img?'':'&#9881;')+'</div><div class="pub-rs-feat-body"><div class="pub-rs-feat-title">'+esc(f.title||'')+'</div><div class="pub-rs-feat-desc">'+esc(f.desc||'')+'</div></div></div>').join('')+'</div>':'')
    +(gallery.length?'<h2 style="font-family:\'Playfair Display\',serif;color:var(--g1);font-size:1.5rem;margin-top:28px;margin-bottom:16px;">Robot Gallery</h2><div class="pub-rs-gallery">'+gallery.map(img=>'<img class="pub-rs-gallery-img" src="'+esc(img)+'" alt="">').join('')+'</div>':'');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// LIVESTREAM
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let lsData = {};

function initLivestream(page) {
  try { lsData = JSON.parse(page.body || '{}'); } catch { lsData = {}; }
  if (!lsData.status) lsData.status = 'offline';
  if (!lsData.pastStreams) lsData.pastStreams = [];

  document.getElementById('ls-stream-url').value    = lsData.streamUrl    || '';
  document.getElementById('ls-chat-url').value      = lsData.chatUrl      || '';
  document.getElementById('ls-scheduled-time').value = lsData.scheduledTime || '';
  document.getElementById('ls-scheduled-desc').value = lsData.scheduledDesc || '';
  document.getElementById('ls-offline-msg').value   = lsData.offlineMsg   || 'No stream currently live. Check back during competitions!';
  document.getElementById('ls-offline-img').value   = lsData.offlineImg   || '';
  const prev = document.getElementById('ls-offline-img-prev');
  if (prev && lsData.offlineImg) { prev.style.backgroundImage = 'url(\'' + lsData.offlineImg + '\')'; prev.style.backgroundSize = 'cover'; prev.textContent = ''; }

  setLsStatus(lsData.status, true);
  renderPastStreamsList();
}

function setLsStatus(status, silent) {
  lsData.status = status;
  ['live','soon','offline'].forEach(s => {
    const btn = document.getElementById('ls-status-' + s);
    if (btn) btn.classList.toggle('ls-status-active', s === status);
  });
  document.getElementById('ls-live-fields').style.display    = status === 'live'    ? 'block' : 'none';
  document.getElementById('ls-soon-fields').style.display    = status === 'soon'    ? 'block' : 'none';
  document.getElementById('ls-offline-fields').style.display = status === 'offline' ? 'block' : 'none';
}

function saveLivestream() {
  lsData.streamUrl     = document.getElementById('ls-stream-url').value.trim();
  lsData.chatUrl       = document.getElementById('ls-chat-url').value.trim();
  lsData.scheduledTime = document.getElementById('ls-scheduled-time').value.trim();
  lsData.scheduledDesc = document.getElementById('ls-scheduled-desc').value.trim();
  lsData.offlineMsg    = document.getElementById('ls-offline-msg').value.trim();
  lsData.offlineImg    = document.getElementById('ls-offline-img').value.trim();
  // Save past streams from DOM
  document.querySelectorAll('.ls-ps-row').forEach(row => {
    const ps = lsData.pastStreams.find(p => p.id === row.dataset.psid); if (!ps) return;
    ps.event = row.querySelector('.lsp-event').value.trim();
    ps.title = row.querySelector('.lsp-title').value.trim();
    ps.date  = row.querySelector('.lsp-date').value.trim();
    ps.url   = row.querySelector('.lsp-url').value.trim();
  });
  return JSON.stringify(lsData);
}

function setLsOfflineUrl() {
  const url = prompt('Paste background image URL:'); if (!url) return;
  lsData.offlineImg = url;
  document.getElementById('ls-offline-img').value = url;
  const prev = document.getElementById('ls-offline-img-prev');
  if (prev) { prev.style.backgroundImage = 'url(\'' + url + '\')'; prev.style.backgroundSize = 'cover'; prev.textContent = ''; }
}
function handleLsOfflinePhoto(ev) {
  const f = ev.target.files[0]; if (!f) return;
  const r = new FileReader();
  r.onload = e2 => {
    lsData.offlineImg = e2.target.result;
    document.getElementById('ls-offline-img').value = e2.target.result;
    const prev = document.getElementById('ls-offline-img-prev');
    if (prev) { prev.style.backgroundImage = 'url(\'' + e2.target.result + '\')'; prev.style.backgroundSize = 'cover'; prev.textContent = ''; }
  };
  r.readAsDataURL(f); ev.target.value = '';
}
function clearLsOfflineImg() {
  lsData.offlineImg = '';
  document.getElementById('ls-offline-img').value = '';
  const prev = document.getElementById('ls-offline-img-prev');
  if (prev) { prev.style.backgroundImage = ''; prev.textContent = 'ğŸ“¡'; }
}

function addPastStream() {
  saveLivestream();
  lsData.pastStreams.push({ id: uid(), event: '', title: 'Match Recording', date: '', url: '' });
  renderPastStreamsList();
}
function delPastStream(id) { saveLivestream(); lsData.pastStreams = lsData.pastStreams.filter(p => p.id !== id); renderPastStreamsList(); }

function renderPastStreamsList() {
  const c = document.getElementById('ls-past-streams-list'); if (!c) return;
  c.innerHTML = '';
  if (!lsData.pastStreams.length) {
    c.innerHTML = '<p style="font-size:.78rem;color:var(--muted)">No past streams yet.</p>';
    return;
  }
  lsData.pastStreams.forEach((ps, i) => {
    const row = document.createElement('div');
    row.className = 'ls-ps-row'; row.dataset.psid = ps.id;
    row.style.cssText = 'background:var(--g6);border:1.5px solid var(--border);border-radius:10px;padding:10px 12px;margin-bottom:7px;';
    row.innerHTML =
      '<div style="display:flex;gap:6px;flex-wrap:wrap;align-items:center">'
        + '<input class="lsp-event tm-in" type="text" placeholder="Event name" value="' + esc(ps.event||'') + '" style="flex:1;min-width:110px">'
        + '<input class="lsp-title tm-in" type="text" placeholder="Stream title" value="' + esc(ps.title||'') + '" style="flex:2;min-width:130px">'
        + '<input class="lsp-date tm-in" type="text" placeholder="Date" value="' + esc(ps.date||'') + '" style="flex:1;min-width:90px">'
        + '<input class="lsp-url tm-in" type="url" placeholder="YouTube/Vimeo URL" value="' + esc(ps.url||'') + '" style="flex:3;min-width:160px">'
        + '<button onclick="delPastStream(\'' + ps.id + '\')" style="background:none;border:none;cursor:pointer;color:#c53030;font-size:1rem;padding:4px">&#10005;</button>'
      + '</div>';
    c.appendChild(row);
  });
}

function renderLivestreamPublic(body) {
  let d; try { d = JSON.parse(body || '{}'); } catch { d = {}; }
  const status = d.status || 'offline';
  let mainHtml = '';

  if (status === 'live' && d.streamUrl) {
    const embed = videoEmbedUrl(d.streamUrl);
    const chatEmbed = d.chatUrl ? d.chatUrl : '';
    const hasChat = !!chatEmbed;

    mainHtml =
      '<div class="pub-ls-live-badge"><span class="pub-ls-live-dot"></span>LIVE NOW</div>'
      + (hasChat
        ? '<div class="pub-ls-with-chat">'
            + '<div class="pub-ls-embed-wrap">' + (embed ? '<iframe src="' + embed + '" allowfullscreen allow="accelerometer;autoplay;clipboard-write;encrypted-media;gyroscope;picture-in-picture"></iframe>' : '<div style="color:rgba(255,255,255,.5);display:flex;height:100%;align-items:center;justify-content:center">Stream unavailable</div>') + '</div>'
            + '<div class="pub-ls-chat-wrap"><iframe src="' + esc(chatEmbed) + '" frameborder="0"></iframe></div>'
          + '</div>'
        : '<div class="pub-ls-embed-wrap">' + (embed ? '<iframe src="' + embed + '" allowfullscreen allow="accelerometer;autoplay;clipboard-write;encrypted-media;gyroscope;picture-in-picture"></iframe>' : '<div style="color:rgba(255,255,255,.5);display:flex;height:100%;align-items:center;justify-content:center">Stream unavailable</div>') + '</div>'
      );

  } else if (status === 'soon') {
    mainHtml =
      '<div class="pub-ls-soon-card">'
        + '<div class="pub-ls-soon-icon">ğŸ“¡</div>'
        + '<div class="pub-ls-soon-label">Stream Starting Soon</div>'
        + '<div class="pub-ls-soon-time">' + esc(d.scheduledTime || 'Time TBD') + '</div>'
        + (d.scheduledDesc ? '<div class="pub-ls-soon-desc">' + esc(d.scheduledDesc) + '</div>' : '')
        + '<div class="pub-ls-soon-hint">Refresh this page when it\'s time to watch</div>'
      + '</div>';

  } else {
    // Offline
    mainHtml =
      '<div class="pub-ls-offline-card">'
        + (d.offlineImg ? '<div class="pub-ls-offline-bg" style="background-image:url(\'' + esc(d.offlineImg) + '\')"></div>' : '')
        + '<div class="pub-ls-offline-inner">'
          + '<div class="pub-ls-offline-icon">ğŸ“¡</div>'
          + '<div class="pub-ls-offline-msg">' + esc(d.offlineMsg || 'No stream currently live.') + '</div>'
        + '</div>'
      + '</div>';
  }

  // Past streams
  const pastStreams = d.pastStreams || [];
  let pastHtml = '';
  if (pastStreams.length) {
    pastHtml =
      '<div class="pub-ls-past-section">'
        + '<div class="pub-ls-past-heading">Past Streams</div>'
        + '<div class="pub-ls-past-grid">' + pastStreams.map(ps => {
            const embed = videoEmbedUrl(ps.url || '');
            const ytMatch = (ps.url||'').match(/(?:youtube\.com\/watch\?v=|youtu\.be\/)([^&\s]+)/);
            const thumb = ytMatch ? 'https://img.youtube.com/vi/' + ytMatch[1] + '/mqdefault.jpg' : '';
            return '<div class="pub-ls-past-card">'
              + '<div class="pub-ls-past-thumb" style="' + (thumb ? 'background-image:url(\'' + thumb + '\')' : 'background:var(--g1)') + '" onclick="openPastStream(\'' + esc(ps.url||'') + '\', this)">'
                + '<div class="pub-ls-past-play">&#9654;</div>'
              + '</div>'
              + '<div class="pub-ls-past-info">'
                + (ps.event ? '<div class="pub-ls-past-event">' + esc(ps.event) + '</div>' : '')
                + '<div class="pub-ls-past-title">' + esc(ps.title || 'Recording') + '</div>'
                + (ps.date ? '<div class="pub-ls-past-date">' + esc(ps.date) + '</div>' : '')
              + '</div>'
            + '</div>';
          }).join('') + '</div>'
      + '</div>';
  }

  return '<div class="pub-ls-wrap">' + mainHtml + pastHtml + '</div>';
}

function openPastStream(url, thumbEl) {
  const embed = videoEmbedUrl(url); if (!embed) return;
  const card = thumbEl.closest('.pub-ls-past-card');
  const embedDiv = document.createElement('div');
  embedDiv.className = 'pub-mv-embed';
  embedDiv.innerHTML = '<iframe src="' + embed + '?autoplay=1" allowfullscreen allow="autoplay;accelerometer;clipboard-write;encrypted-media;gyroscope;picture-in-picture"></iframe>';
  thumbEl.replaceWith(embedDiv);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CANVAS (stub)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function initCanvas(page) {}
function saveCanvas() { return ''; }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TEMPLATE PICKER RENDERING
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderTemplatePicker() {
  const grid = document.getElementById('template-grid'); if (!grid) return;
  grid.innerHTML = '';
  TEMPLATES.forEach(t => {
    const card = document.createElement('div');
    card.className = 'tpl-card' + (t.id === selTpl ? ' selected' : '');
    card.dataset.tpl = t.id;
    card.onclick = () => selectTpl(t.id);
    card.innerHTML = '<div style="font-size:1.8rem;margin-bottom:6px">' + t.icon + '</div>'
      + '<div style="font-weight:700;font-size:.85rem;color:var(--g1)">' + esc(t.name) + '</div>'
      + '<div style="font-size:.72rem;color:var(--muted);margin-top:2px">' + esc(t.desc) + '</div>';
    grid.appendChild(card);
  });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SETTINGS PANEL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function applySettings() {
  site.siteName = document.getElementById('site-name').value.trim() || 'My Website';
  site.footer   = document.getElementById('footer-text').value.trim();
  site.tabTitle = document.getElementById('tab-title').value.trim();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ASYNC INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function init() {
  site = (await pGet(KEY_SITE)) || defaultSite();
  const home = site.pages.find(p => p.isHome);
  if (home && !home.pageType) { home.pageType = 'home'; if (!home.body) home.body = defaultHomeBody(); }
  if (home && home.pageType === 'home') {
    try {
      const d   = JSON.parse(home.body || '{}');
      const def = JSON.parse(defaultHomeBody());
      const merged = Object.assign({}, def, d);
      merged.features = (merged.features || []).map(f => Object.assign({img:'',link:'',icon:'â­',title:'',desc:''}, f));
      home.body = JSON.stringify(merged);
    } catch {}
  }
  renderPublicSite(site.currentPage || 'home');
  checkAdminSession();
}

init();
</script>
</body>
</html>